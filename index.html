
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Entry Strike - ä»•è¨³æ ¼é—˜ã‚²ãƒ¼ãƒ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', 'Hiragino Sans', sans-serif;
            background: #0a0a0a;
            min-height: 100vh;
            overflow: hidden;
            color: #fff;
            user-select: none;
        }

        .game-container {
            width: 100%;
            height: 100vh;
            position: relative;
            background: linear-gradient(180deg, #1a0a2e 0%, #0d1b2a 50%, #1b263b 100%);
            overflow: hidden;
        }

        /* èƒŒæ™¯ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        .bg-effect {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 50% 100%, rgba(230, 57, 70, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        /* ãƒãƒˆãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ */
        .battlefield {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.7) 100%);
        }

        .ground {
            position: absolute;
            bottom: 195px;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent 0%, #4ecdc4 20%, #4ecdc4 80%, transparent 100%);
            box-shadow: 0 0 20px #4ecdc4;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼UI */
        .game-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            z-index: 100;
        }

        .player-status {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .hp-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .hp-label {
            font-size: 12px;
            color: #ff6b6b;
            font-weight: bold;
        }

        .hp-bar-bg {
            width: 150px;
            height: 18px;
            background: #222;
            border-radius: 9px;
            border: 2px solid #e63946;
            overflow: hidden;
            position: relative;
        }

        .hp-bar {
            height: 100%;
            background: linear-gradient(90deg, #e63946 0%, #ff6b6b 100%);
            transition: width 0.3s ease;
            position: relative;
        }

        .hp-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(180deg, rgba(255,255,255,0.3) 0%, transparent 100%);
        }

        /* å¿…æ®ºæŠ€ã‚²ãƒ¼ã‚¸ */
        .special-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .special-label {
            font-size: 10px;
            color: #ffd60a;
            font-weight: bold;
        }

        .special-bar-bg {
            width: 150px;
            height: 12px;
            background: #222;
            border-radius: 6px;
            border: 2px solid #ffd60a;
            overflow: hidden;
        }

        .special-bar {
            height: 100%;
            background: linear-gradient(90deg, #f39c12 0%, #ffd60a 100%);
            transition: width 0.3s ease;
            width: 0%;
        }

        .special-bar.ready {
            animation: specialReady 0.5s ease infinite alternate;
        }

        @keyframes specialReady {
            from { box-shadow: 0 0 5px #ffd60a; }
            to { box-shadow: 0 0 20px #ffd60a, 0 0 30px #f39c12; }
        }

        .stats {
            display: flex;
            gap: 15px;
        }

        .stat-box {
            text-align: center;
            background: rgba(0,0,0,0.5);
            padding: 5px 12px;
            border-radius: 8px;
        }

        .stat-label {
            font-size: 9px;
            color: #888;
            text-transform: uppercase;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #ffd60a;
        }

        /* ã‚³ãƒ³ãƒœè¡¨ç¤º */
        .combo-display {
            position: absolute;
            top: 70px;
            left: 20px;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.2s ease;
        }

        .combo-display.active {
            opacity: 1;
            transform: scale(1);
        }

        .combo-count {
            font-size: 48px;
            font-weight: bold;
            color: #ffd60a;
            text-shadow: 0 0 20px #f39c12, 2px 2px 0 #000;
            line-height: 1;
        }

        .combo-label {
            font-size: 14px;
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 1px 1px 0 #000;
        }

        /* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚­ãƒ£ãƒ© */
        .player {
            position: absolute;
            bottom: 200px;
            left: 15%;
            font-size: 64px;
            z-index: 60;
            transition: all 0.1s ease;
            filter: drop-shadow(0 0 10px rgba(78, 205, 196, 0.5));
        }

        .player.attack {
            animation: playerAttack 0.4s ease-out;
        }

        @keyframes playerAttack {
            0% { transform: translateX(0); }
            30% { transform: translateX(100px) scale(1.2); }
            50% { transform: translateX(150px) scale(1.3); }
            100% { transform: translateX(0) scale(1); }
        }

        .player.damage {
            animation: playerDamage 0.4s ease;
        }

        @keyframes playerDamage {
            0%, 100% { transform: translateX(0); filter: drop-shadow(0 0 10px rgba(78, 205, 196, 0.5)); }
            20%, 60% { transform: translateX(-20px); filter: brightness(2) drop-shadow(0 0 20px #e63946); }
            40%, 80% { transform: translateX(10px); filter: brightness(0.5); }
        }

        .player.special {
            animation: playerSpecial 0.8s ease-out;
        }

        @keyframes playerSpecial {
            0% { transform: translateX(0) scale(1); }
            20% { transform: translateX(-30px) scale(1.5); }
            40% { transform: translateX(200px) scale(2); filter: brightness(2) hue-rotate(30deg); }
            60% { transform: translateX(250px) scale(1.8); }
            100% { transform: translateX(0) scale(1); }
        }

        /* æ•µã‚­ãƒ£ãƒ© */
        .enemy {
            position: absolute;
            bottom: 200px;
            right: 10%;
            z-index: 50;
            transition: right 0.1s linear;
        }

        .enemy-sprite {
            font-size: 64px;
            filter: drop-shadow(0 0 10px rgba(230, 57, 70, 0.5));
            transition: transform 0.2s ease;
        }

        .enemy.boss .enemy-sprite {
            font-size: 80px;
            filter: drop-shadow(0 0 20px rgba(255, 214, 10, 0.8));
        }

        .enemy.hit .enemy-sprite {
            animation: enemyHit 0.3s ease;
        }

        @keyframes enemyHit {
            0% { transform: translateX(0) scale(1); }
            30% { transform: translateX(30px) scale(0.8); filter: brightness(3); }
            100% { transform: translateX(0) scale(1); }
        }

        .enemy.attacking .enemy-sprite {
            animation: enemyAttack 0.5s ease;
        }

        @keyframes enemyAttack {
            0% { transform: translateX(0); }
            40% { transform: translateX(-150px) scale(1.3); }
            60% { transform: translateX(-180px) scale(1.2); }
            100% { transform: translateX(0) scale(1); }
        }

        .enemy.defeated {
            animation: enemyDefeated 0.6s ease-out forwards;
        }

        @keyframes enemyDefeated {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5) rotate(10deg); filter: brightness(3); }
            100% { opacity: 0; transform: scale(0) rotate(45deg) translateY(-100px); }
        }

        /* æ•µã®æƒ…å ±ãƒ‘ãƒãƒ« */
        .enemy-info {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #e63946;
            border-radius: 10px;
            padding: 10px 15px;
            min-width: 200px;
            text-align: center;
            margin-bottom: 10px;
        }

        .enemy.boss .enemy-info {
            border-color: #ffd60a;
            box-shadow: 0 0 30px rgba(255, 214, 10, 0.5);
        }

        .enemy-name {
            font-size: 14px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 3px;
        }

        .enemy-name-en {
            font-size: 10px;
            color: #4ecdc4;
            margin-bottom: 8px;
        }

        .enemy-hp-bar-bg {
            width: 100%;
            height: 10px;
            background: #333;
            border-radius: 5px;
            overflow: hidden;
        }

        .enemy-hp-bar {
            height: 100%;
            background: linear-gradient(90deg, #e63946 0%, #ff6b6b 100%);
            transition: width 0.3s ease;
        }

        .enemy.boss .enemy-hp-bar {
            background: linear-gradient(90deg, #f39c12 0%, #ffd60a 100%);
        }

        /* ãƒœã‚¹ç™»å ´æ¼”å‡º */
        .boss-warning {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 500;
            opacity: 0;
            pointer-events: none;
        }

        .boss-warning.show {
            animation: bossWarningAnim 2s ease-out forwards;
        }

        @keyframes bossWarningAnim {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }

        .boss-warning-text {
            font-size: 48px;
            font-weight: bold;
            color: #ffd60a;
            text-shadow: 0 0 30px #e63946, 0 0 60px #e63946;
            animation: bossTextPulse 0.3s ease infinite alternate;
        }

        @keyframes bossTextPulse {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }

        /* å…¥åŠ›ã‚¨ãƒªã‚¢ */
        .input-area {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 95%;
            max-width: 500px;
            z-index: 100;
        }

        .question-display {
            text-align: center;
            margin-bottom: 10px;
            padding: 8px;
            background: rgba(0,0,0,0.7);
            border-radius: 8px;
            border: 1px solid #415a77;
        }

        .question-text {
            font-size: 16px;
            font-weight: bold;
            color: #fff;
        }

        .question-text-en {
            font-size: 11px;
            color: #4ecdc4;
        }

        .selection-row {
            margin-bottom: 8px;
        }

        .selection-label {
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .selection-label.debit { color: #4ecdc4; }
        .selection-label.credit { color: #ff6b6b; }

        .selected-display {
            font-size: 11px;
            padding: 3px 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }

        .choices {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 6px;
        }

        .choice-btn {
            padding: 10px 6px;
            background: linear-gradient(135deg, #1a1a2e 0%, #0d1b2a 100%);
            border: 2px solid #415a77;
            border-radius: 8px;
            color: #fff;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: center;
        }

        .choice-btn:active { transform: scale(0.95); }
        .choice-btn.selected {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.3);
            box-shadow: 0 0 10px rgba(78, 205, 196, 0.3);
        }
        .choice-btn.correct {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.5);
        }
        .choice-btn.incorrect {
            border-color: #e63946;
            background: rgba(230, 57, 70, 0.5);
        }

        .choice-en { font-size: 10px; color: #4ecdc4; }
        .choice-jp { font-size: 12px; color: #fff; }

        /* ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ */
        .button-row {
            display: flex;
            gap: 10px;
        }

        .attack-btn {
            flex: 1;
            padding: 12px;
            background: linear-gradient(135deg, #e63946 0%, #ff6b6b 100%);
            border: none;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .attack-btn:disabled {
            background: #333;
            color: #666;
        }

        .special-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #f39c12 0%, #ffd60a 100%);
            border: none;
            border-radius: 8px;
            color: #000;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            opacity: 0.3;
            transition: all 0.2s ease;
        }

        .special-btn.ready {
            opacity: 1;
            animation: specialBtnPulse 0.5s ease infinite alternate;
        }

        @keyframes specialBtnPulse {
            from { box-shadow: 0 0 10px #ffd60a; }
            to { box-shadow: 0 0 30px #ffd60a; }
        }

        /* ãƒ’ãƒƒãƒˆã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
        .hit-effect {
            position: fixed;
            top: 40%;
            left: 60%;
            font-size: 72px;
            font-weight: bold;
            color: #4ecdc4;
            text-shadow: 0 0 30px #4ecdc4, 3px 3px 0 #000;
            pointer-events: none;
            opacity: 0;
            z-index: 200;
        }

        .hit-effect.show {
            animation: hitEffectAnim 0.5s ease-out forwards;
        }

        @keyframes hitEffectAnim {
            0% { opacity: 1; transform: scale(0.5) rotate(-10deg); }
            30% { opacity: 1; transform: scale(1.3) rotate(5deg); }
            100% { opacity: 0; transform: scale(1.5) translateY(-50px) rotate(0deg); }
        }

        .damage-text {
            position: fixed;
            top: 35%;
            left: 20%;
            font-size: 48px;
            font-weight: bold;
            color: #e63946;
            text-shadow: 0 0 20px #e63946, 2px 2px 0 #000;
            pointer-events: none;
            opacity: 0;
            z-index: 200;
        }

        .damage-text.show {
            animation: damageTextAnim 0.6s ease-out forwards;
        }

        @keyframes damageTextAnim {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: translateY(-30px); }
        }

        /* ç”»é¢ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ */
        .screen-flash {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 150;
            opacity: 0;
        }

        .screen-flash.hit {
            background: #4ecdc4;
            animation: flashAnim 0.1s ease;
        }

        .screen-flash.damage {
            background: #e63946;
            animation: flashAnim 0.15s ease;
        }

        @keyframes flashAnim {
            0% { opacity: 0.5; }
            100% { opacity: 0; }
        }

        /* ç”»é¢ã‚·ã‚§ã‚¤ã‚¯ */
        .game-container.shake {
            animation: screenShake 0.3s ease;
        }

        @keyframes screenShake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-10px) rotate(-1deg); }
            40% { transform: translateX(10px) rotate(1deg); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .overlay.show {
            opacity: 1;
            pointer-events: auto;
        }

        .overlay-content {
            text-align: center;
            max-width: 400px;
            padding: 30px 20px;
            width: 95%;
        }

        .game-title {
            font-size: 42px;
            font-weight: bold;
            background: linear-gradient(135deg, #4ecdc4 0%, #ffd60a 50%, #ff6b6b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
        }

        .game-subtitle {
            font-size: 16px;
            color: #778da9;
            margin-bottom: 25px;
        }

        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: left;
            font-size: 13px;
            line-height: 1.9;
        }

        .instructions h3 {
            color: #4ecdc4;
            margin-bottom: 10px;
        }

        .start-btn {
            padding: 18px 60px;
            background: linear-gradient(135deg, #e63946 0%, #ff6b6b 100%);
            border: none;
            border-radius: 12px;
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 3px;
            transition: transform 0.2s;
        }

        .start-btn:active { transform: scale(0.95); }

        .result-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 20px 0;
        }

        .result-stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
        }

        .result-stat .label { font-size: 11px; color: #888; }
        .result-stat .value { font-size: 26px; font-weight: bold; color: #4ecdc4; }

        /* ã‚¿ã‚¤ãƒãƒ¼ï¼ˆæ•µã®æ¥è¿‘åº¦ï¼‰ */
        .approach-indicator {
            position: absolute;
            bottom: 190px;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .approach-bar-bg {
            flex: 1;
            height: 6px;
            background: #222;
            border-radius: 3px;
            overflow: hidden;
        }

        .approach-bar {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4 0%, #ffd60a 50%, #e63946 100%);
            transition: width 0.1s linear;
        }

        .approach-label {
            font-size: 10px;
            color: #888;
        }

        /* ã‚¹ãƒãƒ›å¯¾å¿œ - ç¸¦å‹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        @media (max-width: 600px) {
            .game-container {
                display: flex;
                flex-direction: column;
                height: 100vh;
                height: 100dvh;
            }

            .bg-effect { display: none; }

            /* ãƒ˜ãƒƒãƒ€ãƒ¼ï¼šã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ */
            .game-header {
                position: relative;
                padding: 8px;
                flex-shrink: 0;
            }

            .hp-bar-bg { width: 80px; height: 12px; }
            .special-bar-bg { width: 80px; height: 8px; }
            .hp-label, .special-label { font-size: 10px; }
            .stat-box { padding: 3px 6px; }
            .stat-value { font-size: 14px; }
            .stat-label { font-size: 8px; }

            /* å…¥åŠ›ã‚¨ãƒªã‚¢ï¼šä¸Šéƒ¨ã«é…ç½® */
            .input-area {
                position: relative;
                top: auto;
                bottom: auto;
                left: auto;
                transform: none;
                width: 100%;
                max-width: none;
                padding: 5px 8px;
                flex-shrink: 0;
                order: -1;
            }

            .question-display {
                padding: 8px;
                margin-bottom: 8px;
            }

            .question-text { font-size: 15px; }
            .question-text-en { font-size: 10px; }

            .selection-row { margin-bottom: 6px; }
            .selection-label { font-size: 11px; margin-bottom: 4px; }

            .choices { gap: 5px; }

            .choice-btn {
                padding: 14px 6px;
                min-height: 54px;
            }

            .choice-en { font-size: 9px; }
            .choice-jp { font-size: 12px; font-weight: bold; }

            .button-row { gap: 8px; margin-top: 5px; }

            .attack-btn {
                padding: 16px;
                font-size: 18px;
                min-height: 56px;
            }

            .special-btn {
                padding: 16px;
                font-size: 16px;
                min-height: 56px;
            }

            /* ãƒãƒˆãƒ«ã‚¨ãƒªã‚¢ï¼šä¸‹éƒ¨ã«ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆé…ç½® */
            .battlefield {
                position: relative;
                height: auto;
                flex: 1;
                min-height: 100px;
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 10px 20px;
                background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.5) 100%);
            }

            .ground { display: none; }

            .player {
                position: relative;
                bottom: auto;
                left: auto;
                font-size: 48px;
            }

            .enemy {
                position: relative;
                bottom: auto;
                right: auto !important;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .enemy-sprite { font-size: 48px; }
            .enemy.boss .enemy-sprite { font-size: 60px; }

            .enemy-info {
                position: relative;
                bottom: auto;
                left: auto;
                transform: none;
                min-width: 120px;
                padding: 5px 8px;
                margin-bottom: 5px;
            }

            .enemy-name { font-size: 11px; }
            .enemy-name-en { font-size: 9px; }

            .approach-indicator {
                position: absolute;
                bottom: 5px;
                left: 50%;
                transform: translateX(-50%);
                width: 80%;
            }

            /* ã‚³ãƒ³ãƒœè¡¨ç¤º */
            .combo-display {
                position: absolute;
                top: auto;
                bottom: 30px;
                left: 50%;
                transform: translateX(-50%);
            }

            .combo-count { font-size: 32px; }
            .combo-label { font-size: 10px; }

            /* ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ */
            .hit-effect { font-size: 48px; top: 50%; }
            .damage-text { font-size: 32px; top: 50%; left: 50%; transform: translateX(-50%); }
            .boss-warning-text { font-size: 28px; }

            /* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
            .game-title { font-size: 28px; }
            .instructions { padding: 12px; font-size: 12px; line-height: 1.7; }
            .instructions h3 { font-size: 14px; }
            .start-btn { padding: 14px 40px; font-size: 18px; }
            .result-stats { gap: 8px; }
            .result-stat { padding: 10px; }
            .result-stat .value { font-size: 22px; }
        }
    </style>
</head>
<body>
    <div class="game-container" id="gameContainer">
        <div class="bg-effect"></div>

        <!-- ã‚¹ã‚¿ãƒ¼ãƒˆç”»é¢ -->
        <div class="overlay show" id="startOverlay">
            <div class="overlay-content">
                <h1 class="game-title">ENTRY STRIKE</h1>
                <p class="game-subtitle">ä»•è¨³æ ¼é—˜ã‚²ãƒ¼ãƒ </p>
                <div class="instructions">
                    <h3>éŠã³æ–¹</h3>
                    <p>âš”ï¸ æ•µãŒè¿«ã‚‹å‰ã«æ­£ã—ã„ä»•è¨³ã‚’é¸ã¹ï¼</p>
                    <p>ğŸ¯ Dr/Crã‚’é¸æŠã—ã¦ATTACK!</p>
                    <p>ğŸ’¥ æ­£è§£ã§æ”»æ’ƒã€ä¸æ­£è§£ã§åæ’ƒ</p>
                    <p>ğŸ”¥ ã‚³ãƒ³ãƒœã§å¿…æ®ºã‚²ãƒ¼ã‚¸UP</p>
                    <p>ğŸ‘‘ 5ä½“ã”ã¨ã«ãƒœã‚¹ï¼å¿…æ®ºæŠ€ã§å€’ã›ï¼</p>
                </div>
                <button class="start-btn" onclick="startGame()">FIGHT!</button>
            </div>
        </div>

        <!-- ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ -->
        <div class="overlay" id="gameOverOverlay">
            <div class="overlay-content">
                <h1 class="game-title" id="resultTitle">GAME OVER</h1>
                <div class="result-stats">
                    <div class="result-stat">
                        <div class="label">SCORE</div>
                        <div class="value" id="finalScore">0</div>
                    </div>
                    <div class="result-stat">
                        <div class="label">MAX COMBO</div>
                        <div class="value" id="finalCombo">0</div>
                    </div>
                    <div class="result-stat">
                        <div class="label">ENEMIES</div>
                        <div class="value" id="finalEnemies">0</div>
                    </div>
                    <div class="result-stat">
                        <div class="label">BOSSES</div>
                        <div class="value" id="finalBosses">0</div>
                    </div>
                </div>
                <button class="start-btn" onclick="startGame()">RETRY</button>
            </div>
        </div>

        <!-- ãƒœã‚¹è­¦å‘Š -->
        <div class="boss-warning" id="bossWarning">
            <div class="boss-warning-text">âš ï¸ BOSS APPROACHING âš ï¸</div>
        </div>

        <!-- ã‚²ãƒ¼ãƒ UI -->
        <div class="game-header">
            <div class="player-status">
                <div class="hp-container">
                    <span class="hp-label">HP</span>
                    <div class="hp-bar-bg">
                        <div class="hp-bar" id="playerHpBar"></div>
                    </div>
                </div>
                <div class="special-container">
                    <span class="special-label">SP</span>
                    <div class="special-bar-bg">
                        <div class="special-bar" id="specialBar"></div>
                    </div>
                </div>
            </div>
            <div class="stats">
                <div class="stat-box">
                    <div class="stat-label">Score</div>
                    <div class="stat-value" id="score">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Round</div>
                    <div class="stat-value" id="round">1</div>
                </div>
            </div>
        </div>

        <div class="combo-display" id="comboDisplay">
            <div class="combo-count" id="comboCount">0</div>
            <div class="combo-label">COMBO</div>
        </div>

        <!-- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ -->
        <div class="player" id="player">ğŸ¥·</div>

        <!-- æ•µ -->
        <div class="enemy" id="enemy">
            <div class="enemy-info">
                <div class="enemy-name" id="enemyName">æ•µ</div>
                <div class="enemy-name-en" id="enemyNameEn">Enemy</div>
                <div class="enemy-hp-bar-bg">
                    <div class="enemy-hp-bar" id="enemyHpBar"></div>
                </div>
            </div>
            <div class="enemy-sprite" id="enemySprite">ğŸ‘¹</div>
        </div>

        <!-- æ¥è¿‘ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ -->
        <div class="approach-indicator">
            <span class="approach-label">DANGER</span>
            <div class="approach-bar-bg">
                <div class="approach-bar" id="approachBar"></div>
            </div>
        </div>

        <div class="ground"></div>
        <div class="battlefield"></div>

        <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
        <div class="input-area">
            <div class="question-display">
                <div class="question-text" id="questionText">å•é¡Œ</div>
                <div class="question-text-en" id="questionTextEn">Question</div>
            </div>

            <div class="selection-row" id="debitRow">
                <div class="selection-label debit">
                    Drï¼ˆå€Ÿæ–¹ï¼‰<span class="selected-display" id="debitDisplay">-</span>
                </div>
                <div class="choices" id="debitChoices"></div>
            </div>

            <div class="selection-row" id="creditRow">
                <div class="selection-label credit">
                    Crï¼ˆè²¸æ–¹ï¼‰<span class="selected-display" id="creditDisplay">-</span>
                </div>
                <div class="choices" id="creditChoices"></div>
            </div>

            <div class="button-row">
                <button class="attack-btn" id="attackBtn" onclick="attack()" disabled>ATTACK!</button>
                <button class="special-btn" id="specialBtn" onclick="specialAttack()">å¿…æ®º</button>
            </div>
        </div>

        <!-- ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ -->
        <div class="hit-effect" id="hitEffect">HIT!</div>
        <div class="damage-text" id="damageText">DAMAGE!</div>
        <div class="screen-flash" id="screenFlash"></div>
    </div>

    <script>
        // å‹˜å®šç§‘ç›®
        const ACCOUNTS = {
            cash: { en: 'Cash', jp: 'ç¾é‡‘' },
            accountsReceivable: { en: 'A/R', jp: 'å£²æ›é‡‘' },
            allowanceForDoubtful: { en: 'Allowance', jp: 'è²¸å€’å¼•å½“é‡‘' },
            notesReceivable: { en: 'N/R', jp: 'å—å–æ‰‹å½¢' },
            inventory: { en: 'Inventory', jp: 'æ£šå¸è³‡ç”£' },
            supplies: { en: 'Supplies', jp: 'æ¶ˆè€—å“' },
            prepaidExpenses: { en: 'Prepaid Exp.', jp: 'å‰æ‰•è²»ç”¨' },
            prepaidInsurance: { en: 'Prepaid Ins.', jp: 'å‰æ‰•ä¿é™ºæ–™' },
            equipment: { en: 'Equipment', jp: 'å‚™å“' },
            buildings: { en: 'Buildings', jp: 'å»ºç‰©' },
            land: { en: 'Land', jp: 'åœŸåœ°' },
            vehicles: { en: 'Vehicles', jp: 'è»Šä¸¡' },
            accumulatedDepreciation: { en: 'Acc. Depr.', jp: 'æ¸›ä¾¡å„Ÿå´ç´¯è¨ˆé¡' },
            rightOfUseAsset: { en: 'ROU Asset', jp: 'ä½¿ç”¨æ¨©è³‡ç”£' },
            goodwill: { en: 'Goodwill', jp: 'ã®ã‚Œã‚“' },
            patent: { en: 'Patent', jp: 'ç‰¹è¨±æ¨©' },
            investmentInSub: { en: 'Invest. Sub.', jp: 'å­ä¼šç¤¾æ ªå¼' },
            tradingSecurities: { en: 'Trading Sec.', jp: 'å£²è²·ç›®çš„æœ‰ä¾¡è¨¼åˆ¸' },
            afsSecurities: { en: 'AFS Sec.', jp: 'ãã®ä»–æœ‰ä¾¡è¨¼åˆ¸' },
            accountsPayable: { en: 'A/P', jp: 'è²·æ›é‡‘' },
            notesPayable: { en: 'N/P', jp: 'æ”¯æ‰•æ‰‹å½¢' },
            unearnedRevenue: { en: 'Unearned Rev.', jp: 'å‰å—åç›Š' },
            accruedExpenses: { en: 'Accrued Exp.', jp: 'æœªæ‰•è²»ç”¨' },
            accruedSalaries: { en: 'Accrued Sal.', jp: 'æœªæ‰•çµ¦ä¸' },
            taxesPayable: { en: 'Taxes Pay.', jp: 'æœªæ‰•æ³•äººç¨' },
            dividendsPayable: { en: 'Div. Pay.', jp: 'æœªæ‰•é…å½“é‡‘' },
            bondsPayable: { en: 'Bonds Pay.', jp: 'ç¤¾å‚µ' },
            bondDiscount: { en: 'Bond Disc.', jp: 'ç¤¾å‚µå‰²å¼•' },
            bondPremium: { en: 'Bond Prem.', jp: 'ç¤¾å‚µãƒ—ãƒ¬ãƒŸã‚¢ãƒ ' },
            leaseLiability: { en: 'Lease Liab.', jp: 'ãƒªãƒ¼ã‚¹è² å‚µ' },
            commonStock: { en: 'Common Stock', jp: 'è³‡æœ¬é‡‘' },
            preferredStock: { en: 'Pref. Stock', jp: 'å„ªå…ˆæ ªå¼' },
            apic: { en: 'APIC', jp: 'è³‡æœ¬å‰°ä½™é‡‘' },
            retainedEarnings: { en: 'Ret. Earnings', jp: 'åˆ©ç›Šå‰°ä½™é‡‘' },
            treasuryStock: { en: 'Treasury Stock', jp: 'è‡ªå·±æ ªå¼' },
            dividends: { en: 'Dividends', jp: 'é…å½“é‡‘' },
            oci: { en: 'OCI', jp: 'ãã®ä»–åŒ…æ‹¬åˆ©ç›Š' },
            sales: { en: 'Sales', jp: 'å£²ä¸Š' },
            salesReturns: { en: 'Sales Returns', jp: 'å£²ä¸Šæˆ»ã‚Š' },
            serviceRevenue: { en: 'Service Rev.', jp: 'å½¹å‹™åç›Š' },
            interestIncome: { en: 'Int. Income', jp: 'å—å–åˆ©æ¯' },
            dividendIncome: { en: 'Div. Income', jp: 'å—å–é…å½“é‡‘' },
            gainOnSale: { en: 'Gain on Sale', jp: 'å£²å´ç›Š' },
            costOfGoodsSold: { en: 'COGS', jp: 'å£²ä¸ŠåŸä¾¡' },
            salariesExpense: { en: 'Salaries Exp.', jp: 'çµ¦ä¸' },
            rentExpense: { en: 'Rent Exp.', jp: 'æ”¯æ‰•å®¶è³ƒ' },
            depreciationExpense: { en: 'Depr. Exp.', jp: 'æ¸›ä¾¡å„Ÿå´è²»' },
            amortizationExpense: { en: 'Amort. Exp.', jp: 'å„Ÿå´è²»' },
            suppliesExpense: { en: 'Supplies Exp.', jp: 'æ¶ˆè€—å“è²»' },
            interestExpense: { en: 'Int. Exp.', jp: 'æ”¯æ‰•åˆ©æ¯' },
            utilitiesExpense: { en: 'Utilities Exp.', jp: 'æ°´é“å…‰ç†±è²»' },
            insuranceExpense: { en: 'Insurance Exp.', jp: 'ä¿é™ºæ–™' },
            badDebtExpense: { en: 'Bad Debt Exp.', jp: 'è²¸å€’æå¤±' },
            lossOnSale: { en: 'Loss on Sale', jp: 'å£²å´æ' },
            incomeTaxExpense: { en: 'Tax Exp.', jp: 'æ³•äººç¨ç­‰' }
        };

        // æ•µã®ç¨®é¡
        const ENEMY_SPRITES = ['ğŸ‘¹', 'ğŸ‘º', 'ğŸ‘»', 'ğŸ’€', 'ğŸ‘¾', 'ğŸ¤–', 'ğŸ‘¿', 'ğŸ¦¹'];
        const BOSS_SPRITES = ['ğŸ‰', 'ğŸ‘‘', 'âš”ï¸', 'ğŸ”¥'];

        // å–å¼•ãƒ‡ãƒ¼ã‚¿
        const TRANSACTIONS = {
            normal: [
                // åŸºæœ¬å–å¼•
                { id: 'n1', title: 'å‚™å“ã®è³¼å…¥ï¼ˆç¾é‡‘ï¼‰', titleEn: 'Purchase equipment', debit: 'equipment', credit: 'cash', debitPool: ['equipment', 'supplies', 'inventory', 'buildings'], creditPool: ['cash', 'accountsPayable', 'notesPayable', 'accruedExpenses'] },
                { id: 'n2', title: 'å£²æ›é‡‘ã®å›å', titleEn: 'Collect receivables', debit: 'cash', credit: 'accountsReceivable', debitPool: ['cash', 'inventory', 'supplies', 'equipment'], creditPool: ['accountsReceivable', 'sales', 'unearnedRevenue', 'notesReceivable'] },
                { id: 'n3', title: 'æ¶ˆè€—å“ã®è³¼å…¥', titleEn: 'Purchase supplies', debit: 'supplies', credit: 'cash', debitPool: ['supplies', 'inventory', 'equipment', 'prepaidExpenses'], creditPool: ['cash', 'accountsPayable', 'notesPayable', 'accruedExpenses'] },
                { id: 'n4', title: 'è²·æ›é‡‘ã®æ”¯æ‰•ã„', titleEn: 'Pay accounts payable', debit: 'accountsPayable', credit: 'cash', debitPool: ['accountsPayable', 'notesPayable', 'accruedExpenses', 'unearnedRevenue'], creditPool: ['cash', 'accountsReceivable', 'inventory', 'supplies'] },
                { id: 'n5', title: 'ç¾é‡‘å£²ä¸Š', titleEn: 'Cash sales', debit: 'cash', credit: 'sales', debitPool: ['cash', 'accountsReceivable', 'inventory', 'notesReceivable'], creditPool: ['sales', 'serviceRevenue', 'unearnedRevenue', 'interestIncome'] },
                { id: 'n6', title: 'å•†å“ã®ä»•å…¥ï¼ˆç¾é‡‘ï¼‰', titleEn: 'Purchase inventory', debit: 'inventory', credit: 'cash', debitPool: ['inventory', 'supplies', 'equipment', 'prepaidExpenses'], creditPool: ['cash', 'accountsPayable', 'notesPayable', 'unearnedRevenue'] },
                { id: 'n7', title: 'å•†å“ã®ä»•å…¥ï¼ˆæ›ã‘ï¼‰', titleEn: 'Purchase on account', debit: 'inventory', credit: 'accountsPayable', debitPool: ['inventory', 'supplies', 'equipment', 'buildings'], creditPool: ['accountsPayable', 'cash', 'notesPayable', 'accruedExpenses'] },
                { id: 'n8', title: 'æ¸›ä¾¡å„Ÿå´ã®è¨ˆä¸Š', titleEn: 'Record depreciation', debit: 'depreciationExpense', credit: 'accumulatedDepreciation', debitPool: ['depreciationExpense', 'amortizationExpense', 'rentExpense', 'salariesExpense'], creditPool: ['accumulatedDepreciation', 'cash', 'accountsPayable', 'equipment'] },
                { id: 'n9', title: 'æ›ã‘å£²ä¸Š', titleEn: 'Sales on account', debit: 'accountsReceivable', credit: 'sales', debitPool: ['accountsReceivable', 'cash', 'notesReceivable', 'supplies'], creditPool: ['sales', 'serviceRevenue', 'unearnedRevenue', 'interestIncome'] },
                { id: 'n10', title: 'çµ¦ä¸ã®æ”¯æ‰•ã„', titleEn: 'Pay salaries', debit: 'salariesExpense', credit: 'cash', debitPool: ['salariesExpense', 'rentExpense', 'utilitiesExpense', 'suppliesExpense'], creditPool: ['cash', 'accruedSalaries', 'accountsPayable', 'notesPayable'] },
                { id: 'n11', title: 'å‰æ‰•è²»ç”¨ã®è¨ˆä¸Š', titleEn: 'Record prepaid', debit: 'prepaidExpenses', credit: 'cash', debitPool: ['prepaidExpenses', 'prepaidInsurance', 'supplies', 'inventory'], creditPool: ['cash', 'accountsPayable', 'accruedExpenses', 'notesPayable'] },
                { id: 'n12', title: 'æ¶ˆè€—å“ã®è²»ç”¨åŒ–', titleEn: 'Supplies used', debit: 'suppliesExpense', credit: 'supplies', debitPool: ['suppliesExpense', 'depreciationExpense', 'insuranceExpense', 'rentExpense'], creditPool: ['supplies', 'cash', 'inventory', 'prepaidExpenses'] },
                { id: 'n13', title: 'å®¶è³ƒã®æ”¯æ‰•ã„', titleEn: 'Pay rent', debit: 'rentExpense', credit: 'cash', debitPool: ['rentExpense', 'salariesExpense', 'utilitiesExpense', 'interestExpense'], creditPool: ['cash', 'accountsPayable', 'accruedExpenses', 'prepaidExpenses'] },
                { id: 'n14', title: 'å£²ä¸ŠåŸä¾¡ã®è¨ˆä¸Š', titleEn: 'Record COGS', debit: 'costOfGoodsSold', credit: 'inventory', debitPool: ['costOfGoodsSold', 'suppliesExpense', 'depreciationExpense', 'salariesExpense'], creditPool: ['inventory', 'supplies', 'cash', 'accountsPayable'] },
                { id: 'n15', title: 'å‰å—åç›Šã®åç›ŠåŒ–', titleEn: 'Earn revenue', debit: 'unearnedRevenue', credit: 'serviceRevenue', debitPool: ['unearnedRevenue', 'accountsPayable', 'accruedExpenses', 'notesPayable'], creditPool: ['serviceRevenue', 'sales', 'interestIncome', 'dividendIncome'] },
                { id: 'n16', title: 'ç¤¾å‚µã®ç™ºè¡Œ', titleEn: 'Issue bonds', debit: 'cash', credit: 'bondsPayable', debitPool: ['cash', 'accountsReceivable', 'equipment', 'buildings'], creditPool: ['bondsPayable', 'commonStock', 'notesPayable', 'leaseLiability'] },
                { id: 'n17', title: 'æ ªå¼ã®ç™ºè¡Œ', titleEn: 'Issue stock', debit: 'cash', credit: 'commonStock', debitPool: ['cash', 'equipment', 'buildings', 'land'], creditPool: ['commonStock', 'bondsPayable', 'retainedEarnings', 'apic'] },
                { id: 'n18', title: 'æ”¯æ‰•åˆ©æ¯ã®è¨ˆä¸Š', titleEn: 'Accrue interest', debit: 'interestExpense', credit: 'accruedExpenses', debitPool: ['interestExpense', 'rentExpense', 'salariesExpense', 'depreciationExpense'], creditPool: ['accruedExpenses', 'cash', 'bondsPayable', 'notesPayable'] },
                // è¿½åŠ å–å¼•
                { id: 'n19', title: 'è²¸å€’å¼•å½“é‡‘ã®è¨­å®š', titleEn: 'Record bad debt', debit: 'badDebtExpense', credit: 'allowanceForDoubtful', debitPool: ['badDebtExpense', 'suppliesExpense', 'depreciationExpense', 'salariesExpense'], creditPool: ['allowanceForDoubtful', 'accountsReceivable', 'cash', 'inventory'] },
                { id: 'n20', title: 'å—å–æ‰‹å½¢ã®å–å¾—', titleEn: 'Receive note', debit: 'notesReceivable', credit: 'accountsReceivable', debitPool: ['notesReceivable', 'cash', 'inventory', 'equipment'], creditPool: ['accountsReceivable', 'sales', 'unearnedRevenue', 'cash'] },
                { id: 'n21', title: 'å»ºç‰©ã®è³¼å…¥', titleEn: 'Purchase building', debit: 'buildings', credit: 'cash', debitPool: ['buildings', 'land', 'equipment', 'vehicles'], creditPool: ['cash', 'notesPayable', 'bondsPayable', 'accountsPayable'] },
                { id: 'n22', title: 'è»Šä¸¡ã®è³¼å…¥', titleEn: 'Purchase vehicle', debit: 'vehicles', credit: 'cash', debitPool: ['vehicles', 'equipment', 'buildings', 'land'], creditPool: ['cash', 'notesPayable', 'accountsPayable', 'accruedExpenses'] },
                { id: 'n23', title: 'ä¿é™ºæ–™ã®å‰æ‰•ã„', titleEn: 'Prepay insurance', debit: 'prepaidInsurance', credit: 'cash', debitPool: ['prepaidInsurance', 'prepaidExpenses', 'supplies', 'inventory'], creditPool: ['cash', 'accountsPayable', 'notesPayable', 'accruedExpenses'] },
                { id: 'n24', title: 'ä¿é™ºæ–™ã®è²»ç”¨åŒ–', titleEn: 'Insurance expense', debit: 'insuranceExpense', credit: 'prepaidInsurance', debitPool: ['insuranceExpense', 'rentExpense', 'utilitiesExpense', 'suppliesExpense'], creditPool: ['prepaidInsurance', 'prepaidExpenses', 'cash', 'supplies'] },
                { id: 'n25', title: 'é…å½“ã®å®£è¨€', titleEn: 'Declare dividends', debit: 'dividends', credit: 'dividendsPayable', debitPool: ['dividends', 'retainedEarnings', 'salariesExpense', 'interestExpense'], creditPool: ['dividendsPayable', 'cash', 'accountsPayable', 'accruedExpenses'] },
                { id: 'n26', title: 'é…å½“ã®æ”¯æ‰•ã„', titleEn: 'Pay dividends', debit: 'dividendsPayable', credit: 'cash', debitPool: ['dividendsPayable', 'accountsPayable', 'notesPayable', 'accruedExpenses'], creditPool: ['cash', 'accountsReceivable', 'inventory', 'supplies'] },
                { id: 'n27', title: 'è‡ªå·±æ ªå¼ã®å–å¾—', titleEn: 'Buy treasury stock', debit: 'treasuryStock', credit: 'cash', debitPool: ['treasuryStock', 'tradingSecurities', 'afsSecurities', 'equipment'], creditPool: ['cash', 'accountsPayable', 'notesPayable', 'commonStock'] },
                { id: 'n28', title: 'å—å–åˆ©æ¯ã®è¨ˆä¸Š', titleEn: 'Record interest income', debit: 'cash', credit: 'interestIncome', debitPool: ['cash', 'accountsReceivable', 'notesReceivable', 'inventory'], creditPool: ['interestIncome', 'dividendIncome', 'sales', 'serviceRevenue'] },
                { id: 'n29', title: 'æ³•äººç¨ã®è¨ˆä¸Š', titleEn: 'Record income tax', debit: 'incomeTaxExpense', credit: 'taxesPayable', debitPool: ['incomeTaxExpense', 'salariesExpense', 'rentExpense', 'interestExpense'], creditPool: ['taxesPayable', 'cash', 'accruedExpenses', 'accountsPayable'] },
                { id: 'n30', title: 'æ³•äººç¨ã®æ”¯æ‰•ã„', titleEn: 'Pay income tax', debit: 'taxesPayable', credit: 'cash', debitPool: ['taxesPayable', 'accountsPayable', 'dividendsPayable', 'accruedExpenses'], creditPool: ['cash', 'accountsReceivable', 'inventory', 'notesReceivable'] },
                { id: 'n31', title: 'æœªæ‰•çµ¦ä¸ã®è¨ˆä¸Š', titleEn: 'Accrue salaries', debit: 'salariesExpense', credit: 'accruedSalaries', debitPool: ['salariesExpense', 'rentExpense', 'utilitiesExpense', 'interestExpense'], creditPool: ['accruedSalaries', 'accruedExpenses', 'cash', 'accountsPayable'] },
                { id: 'n32', title: 'æ°´é“å…‰ç†±è²»ã®æ”¯æ‰•ã„', titleEn: 'Pay utilities', debit: 'utilitiesExpense', credit: 'cash', debitPool: ['utilitiesExpense', 'rentExpense', 'salariesExpense', 'insuranceExpense'], creditPool: ['cash', 'accountsPayable', 'accruedExpenses', 'notesPayable'] },
                { id: 'n33', title: 'å£²ä¸Šæˆ»ã‚Šã®è¨ˆä¸Š', titleEn: 'Sales returns', debit: 'salesReturns', credit: 'accountsReceivable', debitPool: ['salesReturns', 'costOfGoodsSold', 'salariesExpense', 'rentExpense'], creditPool: ['accountsReceivable', 'cash', 'inventory', 'unearnedRevenue'] },
                { id: 'n34', title: 'åœŸåœ°ã®è³¼å…¥', titleEn: 'Purchase land', debit: 'land', credit: 'cash', debitPool: ['land', 'buildings', 'equipment', 'vehicles'], creditPool: ['cash', 'notesPayable', 'bondsPayable', 'accountsPayable'] },
                { id: 'n35', title: 'å£²è²·ç›®çš„æœ‰ä¾¡è¨¼åˆ¸ã®è³¼å…¥', titleEn: 'Buy trading securities', debit: 'tradingSecurities', credit: 'cash', debitPool: ['tradingSecurities', 'afsSecurities', 'inventory', 'equipment'], creditPool: ['cash', 'accountsPayable', 'notesPayable', 'bondsPayable'] },
                { id: 'n36', title: 'å—å–é…å½“é‡‘ã®è¨ˆä¸Š', titleEn: 'Receive dividends', debit: 'cash', credit: 'dividendIncome', debitPool: ['cash', 'accountsReceivable', 'notesReceivable', 'tradingSecurities'], creditPool: ['dividendIncome', 'interestIncome', 'sales', 'serviceRevenue'] },
                { id: 'n37', title: 'ã‚µãƒ¼ãƒ“ã‚¹åç›Šï¼ˆç¾é‡‘ï¼‰', titleEn: 'Service revenue (cash)', debit: 'cash', credit: 'serviceRevenue', debitPool: ['cash', 'accountsReceivable', 'notesReceivable', 'inventory'], creditPool: ['serviceRevenue', 'sales', 'interestIncome', 'unearnedRevenue'] },
                { id: 'n38', title: 'å‰å—é‡‘ã®å—å–ã‚Š', titleEn: 'Receive advance', debit: 'cash', credit: 'unearnedRevenue', debitPool: ['cash', 'accountsReceivable', 'notesReceivable', 'inventory'], creditPool: ['unearnedRevenue', 'sales', 'serviceRevenue', 'accountsPayable'] }
            ],
            boss: [
                { id: 'b1', title: 'ãƒªãƒ¼ã‚¹è³‡ç”£ã®è¨ˆä¸Š', titleEn: 'Recognize lease (IFRS16)', debit: 'rightOfUseAsset', credit: 'leaseLiability', debitPool: ['rightOfUseAsset', 'equipment', 'buildings', 'goodwill'], creditPool: ['leaseLiability', 'bondsPayable', 'cash', 'accountsPayable'] },
                { id: 'b2', title: 'ã®ã‚Œã‚“ã®è¨ˆä¸Š', titleEn: 'Record goodwill', debit: 'goodwill', credit: 'cash', debitPool: ['goodwill', 'rightOfUseAsset', 'investmentInSub', 'patent'], creditPool: ['cash', 'bondsPayable', 'commonStock', 'accountsPayable'] },
                { id: 'b3', title: 'é€£çµæ¶ˆå»ï¼šæŠ•è³‡ã¨è³‡æœ¬', titleEn: 'Eliminate investment', debit: 'commonStock', credit: 'investmentInSub', debitPool: ['commonStock', 'retainedEarnings', 'apic', 'goodwill'], creditPool: ['investmentInSub', 'cash', 'bondsPayable', 'leaseLiability'] },
                { id: 'b4', title: 'ãƒªãƒ¼ã‚¹è² å‚µã®è¿”æ¸ˆ', titleEn: 'Lease payment', debit: 'leaseLiability', credit: 'cash', debitPool: ['leaseLiability', 'bondsPayable', 'rightOfUseAsset', 'notesPayable'], creditPool: ['cash', 'accountsPayable', 'accruedExpenses', 'notesPayable'] },
                { id: 'b5', title: 'å­ä¼šç¤¾ã¸ã®æŠ•è³‡', titleEn: 'Invest in subsidiary', debit: 'investmentInSub', credit: 'cash', debitPool: ['investmentInSub', 'goodwill', 'afsSecurities', 'tradingSecurities'], creditPool: ['cash', 'commonStock', 'bondsPayable', 'accountsPayable'] },
                { id: 'b6', title: 'ç¤¾å‚µã®å‰²å¼•ç™ºè¡Œ', titleEn: 'Issue bonds at discount', debit: 'cash', credit: 'bondsPayable', debitPool: ['cash', 'bondDiscount', 'equipment', 'buildings'], creditPool: ['bondsPayable', 'bondPremium', 'commonStock', 'apic'] },
                { id: 'b7', title: 'ç‰¹è¨±æ¨©ã®å–å¾—', titleEn: 'Acquire patent', debit: 'patent', credit: 'cash', debitPool: ['patent', 'goodwill', 'rightOfUseAsset', 'buildings'], creditPool: ['cash', 'accountsPayable', 'notesPayable', 'commonStock'] },
                { id: 'b8', title: 'ç‰¹è¨±æ¨©ã®å„Ÿå´', titleEn: 'Amortize patent', debit: 'amortizationExpense', credit: 'patent', debitPool: ['amortizationExpense', 'depreciationExpense', 'badDebtExpense', 'interestExpense'], creditPool: ['patent', 'goodwill', 'accumulatedDepreciation', 'rightOfUseAsset'] },
                { id: 'b9', title: 'AFSæœ‰ä¾¡è¨¼åˆ¸ã®è³¼å…¥', titleEn: 'Buy AFS securities', debit: 'afsSecurities', credit: 'cash', debitPool: ['afsSecurities', 'tradingSecurities', 'investmentInSub', 'goodwill'], creditPool: ['cash', 'bondsPayable', 'commonStock', 'accountsPayable'] },
                { id: 'b10', title: 'OCIè©•ä¾¡å·®é¡ã®è¨ˆä¸Š', titleEn: 'Record OCI', debit: 'afsSecurities', credit: 'oci', debitPool: ['afsSecurities', 'tradingSecurities', 'goodwill', 'rightOfUseAsset'], creditPool: ['oci', 'retainedEarnings', 'apic', 'gainOnSale'] },
                { id: 'b11', title: 'å„ªå…ˆæ ªå¼ã®ç™ºè¡Œ', titleEn: 'Issue preferred stock', debit: 'cash', credit: 'preferredStock', debitPool: ['cash', 'equipment', 'buildings', 'land'], creditPool: ['preferredStock', 'commonStock', 'apic', 'bondsPayable'] },
                { id: 'b12', title: 'å‚™å“ã®å£²å´ï¼ˆåˆ©ç›Šï¼‰', titleEn: 'Sell equipment (gain)', debit: 'cash', credit: 'gainOnSale', debitPool: ['cash', 'accountsReceivable', 'notesReceivable', 'inventory'], creditPool: ['gainOnSale', 'sales', 'equipment', 'accumulatedDepreciation'] }
            ]
        };

        // ã‚²ãƒ¼ãƒ çŠ¶æ…‹
        let game = {
            hp: 100,
            maxHp: 100,
            score: 0,
            round: 1,
            combo: 0,
            maxCombo: 0,
            specialGauge: 0,
            enemiesDefeated: 0,
            bossesDefeated: 0,
            isRunning: false,
            isBoss: false,
            enemyHp: 1,
            enemyMaxHp: 1,
            currentTransaction: null,
            selectedDebit: null,
            selectedCredit: null,
            approachTimer: null,
            approachValue: 0,
            recentQuestions: []
        };

        // DOMè¦ç´ 
        const $ = id => document.getElementById(id);

        function shuffle(arr) {
            const a = [...arr];
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        function updateUI() {
            $('playerHpBar').style.width = (game.hp / game.maxHp * 100) + '%';
            $('specialBar').style.width = Math.min(100, game.specialGauge) + '%';
            $('specialBar').classList.toggle('ready', game.specialGauge >= 100);
            $('specialBtn').classList.toggle('ready', game.specialGauge >= 100);
            $('score').textContent = game.score;
            $('round').textContent = game.round;
            $('enemyHpBar').style.width = (game.enemyHp / game.enemyMaxHp * 100) + '%';

            $('comboDisplay').classList.toggle('active', game.combo > 0);
            $('comboCount').textContent = game.combo;

            $('attackBtn').disabled = !(game.selectedDebit && game.selectedCredit);
        }

        function spawnEnemy() {
            // ãƒœã‚¹åˆ¤å®š: 5ä½“ã”ã¨
            game.isBoss = game.enemiesDefeated > 0 && game.enemiesDefeated % 5 === 0;

            if (game.isBoss) {
                showBossWarning();
                return;
            }

            setupEnemy();
        }

        function showBossWarning() {
            $('bossWarning').classList.add('show');
            setTimeout(() => {
                $('bossWarning').classList.remove('show');
                setupEnemy();
            }, 2000);
        }

        function setupEnemy() {
            const pool = game.isBoss ? TRANSACTIONS.boss : TRANSACTIONS.normal;
            let available = pool.filter(t => !game.recentQuestions.includes(t.id));
            if (available.length === 0) {
                game.recentQuestions = [];
                available = pool;
            }

            const transaction = available[Math.floor(Math.random() * available.length)];
            game.currentTransaction = transaction;
            game.recentQuestions.push(transaction.id);
            if (game.recentQuestions.length > 5) game.recentQuestions.shift();

            // æ•µã®è¦‹ãŸç›®
            const enemy = $('enemy');
            enemy.classList.remove('defeated', 'hit', 'attacking');
            enemy.classList.toggle('boss', game.isBoss);
            enemy.style.right = '10%';

            const sprite = game.isBoss
                ? BOSS_SPRITES[Math.floor(Math.random() * BOSS_SPRITES.length)]
                : ENEMY_SPRITES[Math.floor(Math.random() * ENEMY_SPRITES.length)];
            $('enemySprite').textContent = sprite;

            // æ•µHPï¼ˆãƒœã‚¹ã‚‚é€šå¸¸æ•µã‚‚1å›æ­£è§£ã§æ’ƒç ´ï¼‰
            game.enemyMaxHp = 1;
            game.enemyHp = 1;

            // å•é¡Œè¡¨ç¤º
            const prefix = game.isBoss ? 'ã€BOSSã€‘' : '';
            $('enemyName').textContent = prefix + transaction.title;
            $('enemyNameEn').textContent = transaction.titleEn;

            if (game.isBoss) {
                // ãƒœã‚¹æˆ¦ï¼šå•é¡Œã¨é¸æŠè‚¢ã‚’è¡¨ç¤ºã€å¿…æ®ºæŠ€ã®ã¿ã§å€’ã™
                $('questionText').textContent = 'ã€BOSSã€‘' + transaction.title;
                $('questionTextEn').textContent = transaction.titleEn;
                $('debitRow').style.display = 'block';
                $('creditRow').style.display = 'block';
                $('attackBtn').style.display = 'none';

                // é¸æŠè‚¢ã‚’ç”Ÿæˆ
                game.selectedDebit = null;
                game.selectedCredit = null;
                $('debitDisplay').textContent = '-';
                $('creditDisplay').textContent = '-';

                const debitChoices = shuffle(transaction.debitPool);
                const creditChoices = shuffle(transaction.creditPool);

                $('debitChoices').innerHTML = '';
                $('creditChoices').innerHTML = '';

                debitChoices.forEach(key => {
                    const btn = createChoiceBtn(key, 'debit');
                    $('debitChoices').appendChild(btn);
                });

                creditChoices.forEach(key => {
                    const btn = createChoiceBtn(key, 'credit');
                    $('creditChoices').appendChild(btn);
                });

                // å¿…æ®ºã‚²ãƒ¼ã‚¸ã‚’100%ã«
                game.specialGauge = 100;
                // æ¥è¿‘ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹ï¼ˆé€šå¸¸æ•µã¨åŒã˜ï¼‰
                game.approachValue = 0;
                startApproachTimer();
            } else {
                // é€šå¸¸æ•µï¼šé¸æŠè‚¢ã‚’è¡¨ç¤º
                $('questionText').textContent = transaction.title;
                $('questionTextEn').textContent = transaction.titleEn;
                $('debitRow').style.display = 'block';
                $('creditRow').style.display = 'block';
                $('attackBtn').style.display = 'block';

                game.selectedDebit = null;
                game.selectedCredit = null;
                $('debitDisplay').textContent = '-';
                $('creditDisplay').textContent = '-';

                const debitChoices = shuffle(transaction.debitPool);
                const creditChoices = shuffle(transaction.creditPool);

                $('debitChoices').innerHTML = '';
                $('creditChoices').innerHTML = '';

                debitChoices.forEach(key => {
                    const btn = createChoiceBtn(key, 'debit');
                    $('debitChoices').appendChild(btn);
                });

                creditChoices.forEach(key => {
                    const btn = createChoiceBtn(key, 'credit');
                    $('creditChoices').appendChild(btn);
                });

                // æ¥è¿‘ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹
                game.approachValue = 0;
                startApproachTimer();
            }

            updateUI();
        }

        function createChoiceBtn(key, type) {
            const acc = ACCOUNTS[key];
            const btn = document.createElement('button');
            btn.className = 'choice-btn';
            btn.innerHTML = `<div class="choice-en">${acc.en}</div><div class="choice-jp">${acc.jp}</div>`;
            btn.onclick = () => selectChoice(key, type);
            btn.dataset.key = key;
            return btn;
        }

        function selectChoice(key, type) {
            if (!game.isRunning) return;

            const container = type === 'debit' ? $('debitChoices') : $('creditChoices');
            container.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('selected'));
            container.querySelector(`[data-key="${key}"]`).classList.add('selected');

            if (type === 'debit') {
                game.selectedDebit = key;
                $('debitDisplay').textContent = ACCOUNTS[key].jp;
            } else {
                game.selectedCredit = key;
                $('creditDisplay').textContent = ACCOUNTS[key].jp;
            }

            updateUI();
        }

        function startApproachTimer() {
            clearInterval(game.approachTimer);
            const maxTime = 100;

            game.approachTimer = setInterval(() => {
                game.approachValue += 1;
                const percent = (game.approachValue / maxTime) * 100;
                $('approachBar').style.width = percent + '%';

                // æ•µãŒæ¥è¿‘
                const approachPercent = Math.min(game.approachValue / maxTime, 1);
                $('enemy').style.right = (10 + approachPercent * 30) + '%';

                if (game.approachValue >= maxTime) {
                    // æ™‚é–“åˆ‡ã‚Œ - æ•µã®æ”»æ’ƒ
                    enemyAttack();
                }
            }, 100);
        }

        function enemyAttack() {
            clearInterval(game.approachTimer);

            $('enemy').classList.add('attacking');
            setTimeout(() => $('enemy').classList.remove('attacking'), 500);

            $('player').classList.add('damage');
            setTimeout(() => $('player').classList.remove('damage'), 400);

            $('screenFlash').classList.add('damage');
            setTimeout(() => $('screenFlash').classList.remove('damage'), 150);

            $('gameContainer').classList.add('shake');
            setTimeout(() => $('gameContainer').classList.remove('shake'), 300);

            $('damageText').textContent = '-20';
            $('damageText').classList.add('show');
            setTimeout(() => $('damageText').classList.remove('show'), 600);

            game.hp -= 20;
            game.combo = 0;
            updateUI();

            if (game.hp <= 0) {
                gameOver();
            } else {
                setTimeout(spawnEnemy, 800);
            }
        }

        function attack() {
            if (!game.isRunning || !game.selectedDebit || !game.selectedCredit) return;
            clearInterval(game.approachTimer);

            const t = game.currentTransaction;
            const debitOk = game.selectedDebit === t.debit;
            const creditOk = game.selectedCredit === t.credit;

            // æ­£è§£è¡¨ç¤º
            $('debitChoices').querySelectorAll('.choice-btn').forEach(btn => {
                if (btn.dataset.key === t.debit) btn.classList.add('correct');
                else if (btn.classList.contains('selected')) btn.classList.add('incorrect');
            });
            $('creditChoices').querySelectorAll('.choice-btn').forEach(btn => {
                if (btn.dataset.key === t.credit) btn.classList.add('correct');
                else if (btn.classList.contains('selected')) btn.classList.add('incorrect');
            });

            if (debitOk && creditOk) {
                // æ­£è§£ï¼
                playerAttack();
            } else {
                // ä¸æ­£è§£
                game.combo = 0;
                $('damageText').textContent = 'MISS!';
                $('damageText').classList.add('show');
                setTimeout(() => $('damageText').classList.remove('show'), 600);

                setTimeout(() => enemyAttack(), 500);
            }
        }

        function playerAttack() {
            $('player').classList.add('attack');
            setTimeout(() => $('player').classList.remove('attack'), 400);

            $('enemy').classList.add('hit');
            setTimeout(() => $('enemy').classList.remove('hit'), 300);

            $('screenFlash').classList.add('hit');
            setTimeout(() => $('screenFlash').classList.remove('hit'), 100);

            game.enemyHp--;
            game.combo++;
            if (game.combo > game.maxCombo) game.maxCombo = game.combo;
            game.specialGauge += 20;

            const baseScore = game.isBoss ? 200 : 100;
            const comboBonus = game.combo * 15;
            const timeBonus = Math.floor((100 - game.approachValue) / 5);
            const totalScore = baseScore + comboBonus + timeBonus;
            game.score += totalScore;

            $('hitEffect').textContent = game.enemyHp > 0 ? 'HIT!' : (game.isBoss ? 'DEFEATED!' : 'K.O!');
            $('hitEffect').classList.add('show');
            setTimeout(() => $('hitEffect').classList.remove('show'), 500);

            updateUI();

            if (game.enemyHp <= 0) {
                // æ•µæ’ƒç ´
                $('enemy').classList.add('defeated');
                game.enemiesDefeated++;
                if (game.isBoss) game.bossesDefeated++;
                game.round++;

                setTimeout(spawnEnemy, 800);
            } else {
                // ãƒœã‚¹ç¶™ç¶š
                setTimeout(() => {
                    game.selectedDebit = null;
                    game.selectedCredit = null;
                    $('debitDisplay').textContent = '-';
                    $('creditDisplay').textContent = '-';
                    $('debitChoices').querySelectorAll('.choice-btn').forEach(b => {
                        b.classList.remove('selected', 'correct', 'incorrect');
                    });
                    $('creditChoices').querySelectorAll('.choice-btn').forEach(b => {
                        b.classList.remove('selected', 'correct', 'incorrect');
                    });
                    game.approachValue = 0;
                    startApproachTimer();
                    updateUI();
                }, 500);
            }
        }

        function specialAttack() {
            if (game.specialGauge < 100 || !game.isRunning) return;

            game.specialGauge = 0;

            $('player').classList.add('special');
            setTimeout(() => $('player').classList.remove('special'), 800);

            $('screenFlash').classList.add('hit');
            setTimeout(() => $('screenFlash').classList.remove('hit'), 100);
            setTimeout(() => {
                $('screenFlash').classList.add('hit');
                setTimeout(() => $('screenFlash').classList.remove('hit'), 100);
            }, 200);

            $('hitEffect').textContent = 'SPECIAL!';
            $('hitEffect').classList.add('show');
            setTimeout(() => $('hitEffect').classList.remove('show'), 500);

            // æ•µã«å¤§ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ˆãƒœã‚¹ã‚‚ä¸€æ’ƒã§å€’ã›ã‚‹ï¼‰
            game.enemyHp -= 3;
            game.score += 300;

            if (game.enemyHp <= 0) {
                clearInterval(game.approachTimer);
                $('enemy').classList.add('defeated');
                game.enemiesDefeated++;
                if (game.isBoss) game.bossesDefeated++;
                game.round++;
                setTimeout(spawnEnemy, 1000);
            }

            updateUI();
        }

        function startGame() {
            game = {
                hp: 100,
                maxHp: 100,
                score: 0,
                round: 1,
                combo: 0,
                maxCombo: 0,
                specialGauge: 0,
                enemiesDefeated: 0,
                bossesDefeated: 0,
                isRunning: true,
                isBoss: false,
                enemyHp: 1,
                enemyMaxHp: 1,
                currentTransaction: null,
                selectedDebit: null,
                selectedCredit: null,
                approachTimer: null,
                approachValue: 0,
                recentQuestions: []
            };

            $('startOverlay').classList.remove('show');
            $('gameOverOverlay').classList.remove('show');
            $('player').classList.remove('attack', 'damage', 'special');
            $('enemy').classList.remove('defeated', 'hit', 'attacking', 'boss');

            // UIã‚’ãƒªã‚»ãƒƒãƒˆ
            $('debitRow').style.display = 'block';
            $('creditRow').style.display = 'block';
            $('attackBtn').style.display = 'block';

            updateUI();
            spawnEnemy();
        }

        function gameOver() {
            game.isRunning = false;
            clearInterval(game.approachTimer);

            $('resultTitle').textContent = game.bossesDefeated >= 3 ? 'VICTORY!' : 'GAME OVER';
            $('finalScore').textContent = game.score;
            $('finalCombo').textContent = game.maxCombo;
            $('finalEnemies').textContent = game.enemiesDefeated;
            $('finalBosses').textContent = game.bossesDefeated;

            $('gameOverOverlay').classList.add('show');
        }

        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰
        document.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                if (!game.isRunning) startGame();
                else attack();
            }
        });
    </script>
</body>
</html>
