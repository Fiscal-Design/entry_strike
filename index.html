
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Entry Strike - ‰ªïË®≥Ê†ºÈóò„Ç≤„Éº„É†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Segoe UI', 'Hiragino Sans', sans-serif;
            background: #0a0a0a;
            min-height: 100vh;
            overflow: hidden;
            color: #fff;
            user-select: none;
        }

        .game-container {
            width: 100%;
            height: 100vh;
            position: relative;
            background: linear-gradient(180deg, #1a0a2e 0%, #0d1b2a 50%, #1b263b 100%);
            overflow: hidden;
        }

        /* ËÉåÊôØ„Ç®„Éï„Çß„ÇØ„Éà */
        .bg-effect {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 50% 100%, rgba(230, 57, 70, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        /* „Éê„Éà„É´„Éï„Ç£„Éº„É´„Éâ */
        .battlefield {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 200px;
            background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.7) 100%);
        }

        .ground {
            position: absolute;
            bottom: 195px;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent 0%, #4ecdc4 20%, #4ecdc4 80%, transparent 100%);
            box-shadow: 0 0 20px #4ecdc4;
        }

        /* „Éò„ÉÉ„ÉÄ„ÉºUI */
        .game-header {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            z-index: 100;
        }

        .player-status {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .hp-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .hp-label {
            font-size: 12px;
            color: #ff6b6b;
            font-weight: bold;
        }

        .hp-bar-bg {
            width: 150px;
            height: 18px;
            background: #222;
            border-radius: 9px;
            border: 2px solid #e63946;
            overflow: hidden;
            position: relative;
        }

        .hp-bar {
            height: 100%;
            background: linear-gradient(90deg, #e63946 0%, #ff6b6b 100%);
            transition: width 0.3s ease;
            position: relative;
        }

        .hp-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 50%;
            background: linear-gradient(180deg, rgba(255,255,255,0.3) 0%, transparent 100%);
        }

        /* ÂøÖÊÆ∫ÊäÄ„Ç≤„Éº„Ç∏ */
        .special-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .special-label {
            font-size: 10px;
            color: #ffd60a;
            font-weight: bold;
        }

        .special-bar-bg {
            width: 150px;
            height: 12px;
            background: #222;
            border-radius: 6px;
            border: 2px solid #ffd60a;
            overflow: hidden;
        }

        .special-bar {
            height: 100%;
            background: linear-gradient(90deg, #f39c12 0%, #ffd60a 100%);
            transition: width 0.3s ease;
            width: 0%;
        }

        .special-bar.ready {
            animation: specialReady 0.5s ease infinite alternate;
        }

        @keyframes specialReady {
            from { box-shadow: 0 0 5px #ffd60a; }
            to { box-shadow: 0 0 20px #ffd60a, 0 0 30px #f39c12; }
        }

        .stats {
            display: flex;
            gap: 15px;
        }

        .stat-box {
            text-align: center;
            background: rgba(0,0,0,0.5);
            padding: 5px 12px;
            border-radius: 8px;
        }

        .stat-label {
            font-size: 9px;
            color: #888;
            text-transform: uppercase;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #ffd60a;
        }

        /* „Ç≥„É≥„ÉúË°®Á§∫ */
        .combo-display {
            position: absolute;
            top: 70px;
            left: 20px;
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.2s ease;
        }

        .combo-display.active {
            opacity: 1;
            transform: scale(1);
        }

        .combo-count {
            font-size: 48px;
            font-weight: bold;
            color: #ffd60a;
            text-shadow: 0 0 20px #f39c12, 2px 2px 0 #000;
            line-height: 1;
        }

        .combo-label {
            font-size: 14px;
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 1px 1px 0 #000;
        }

        /* „Éó„É¨„Ç§„É§„Éº„Ç≠„É£„É© */
        .player {
            position: absolute;
            bottom: 200px;
            left: 15%;
            font-size: 64px;
            z-index: 60;
            transition: all 0.1s ease;
            filter: drop-shadow(0 0 10px rgba(78, 205, 196, 0.5));
        }

        .player.attack {
            animation: playerAttack 0.4s ease-out;
        }

        @keyframes playerAttack {
            0% { transform: translateX(0); }
            30% { transform: translateX(100px) scale(1.2); }
            50% { transform: translateX(150px) scale(1.3); }
            100% { transform: translateX(0) scale(1); }
        }

        .player.damage {
            animation: playerDamage 0.4s ease;
        }

        @keyframes playerDamage {
            0%, 100% { transform: translateX(0); filter: drop-shadow(0 0 10px rgba(78, 205, 196, 0.5)); }
            20%, 60% { transform: translateX(-20px); filter: brightness(2) drop-shadow(0 0 20px #e63946); }
            40%, 80% { transform: translateX(10px); filter: brightness(0.5); }
        }

        .player.special {
            animation: playerSpecial 0.8s ease-out;
        }

        @keyframes playerSpecial {
            0% { transform: translateX(0) scale(1); }
            20% { transform: translateX(-30px) scale(1.5); }
            40% { transform: translateX(200px) scale(2); filter: brightness(2) hue-rotate(30deg); }
            60% { transform: translateX(250px) scale(1.8); }
            100% { transform: translateX(0) scale(1); }
        }

        /* Êïµ„Ç≠„É£„É© */
        .enemy {
            position: absolute;
            bottom: 200px;
            right: 10%;
            z-index: 50;
            transition: right 0.1s linear;
        }

        .enemy-sprite {
            font-size: 64px;
            filter: drop-shadow(0 0 10px rgba(230, 57, 70, 0.5));
            transition: transform 0.2s ease;
        }

        .enemy.boss .enemy-sprite {
            font-size: 80px;
            filter: drop-shadow(0 0 20px rgba(255, 214, 10, 0.8));
        }

        .enemy.hit .enemy-sprite {
            animation: enemyHit 0.3s ease;
        }

        @keyframes enemyHit {
            0% { transform: translateX(0) scale(1); }
            30% { transform: translateX(30px) scale(0.8); filter: brightness(3); }
            100% { transform: translateX(0) scale(1); }
        }

        .enemy.attacking .enemy-sprite {
            animation: enemyAttack 0.5s ease;
        }

        @keyframes enemyAttack {
            0% { transform: translateX(0); }
            40% { transform: translateX(-150px) scale(1.3); }
            60% { transform: translateX(-180px) scale(1.2); }
            100% { transform: translateX(0) scale(1); }
        }

        .enemy.defeated {
            animation: enemyDefeated 0.6s ease-out forwards;
        }

        @keyframes enemyDefeated {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.5) rotate(10deg); filter: brightness(3); }
            100% { opacity: 0; transform: scale(0) rotate(45deg) translateY(-100px); }
        }

        /* Êïµ„ÅÆÊÉÖÂ†±„Éë„Éç„É´ */
        .enemy-info {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            border: 2px solid #e63946;
            border-radius: 10px;
            padding: 10px 15px;
            min-width: 200px;
            text-align: center;
            margin-bottom: 10px;
        }

        .enemy.boss .enemy-info {
            border-color: #ffd60a;
            box-shadow: 0 0 30px rgba(255, 214, 10, 0.5);
        }

        .enemy-name {
            font-size: 14px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 3px;
        }

        .enemy-name-en {
            font-size: 10px;
            color: #4ecdc4;
            margin-bottom: 8px;
        }

        .enemy-hp-bar-bg {
            width: 100%;
            height: 10px;
            background: #333;
            border-radius: 5px;
            overflow: hidden;
        }

        .enemy-hp-bar {
            height: 100%;
            background: linear-gradient(90deg, #e63946 0%, #ff6b6b 100%);
            transition: width 0.3s ease;
        }

        .enemy.boss .enemy-hp-bar {
            background: linear-gradient(90deg, #f39c12 0%, #ffd60a 100%);
        }

        /* „Éú„ÇπÁôªÂ†¥ÊºîÂá∫ */
        .boss-warning {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 500;
            opacity: 0;
            pointer-events: none;
        }

        .boss-warning.show {
            animation: bossWarningAnim 2s ease-out forwards;
        }

        @keyframes bossWarningAnim {
            0% { opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { opacity: 0; }
        }

        .boss-warning-text {
            font-size: 48px;
            font-weight: bold;
            color: #ffd60a;
            text-shadow: 0 0 30px #e63946, 0 0 60px #e63946;
            animation: bossTextPulse 0.3s ease infinite alternate;
        }

        @keyframes bossTextPulse {
            from { transform: scale(1); }
            to { transform: scale(1.1); }
        }

        /* ÂÖ•Âäõ„Ç®„É™„Ç¢ */
        .input-area {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 95%;
            max-width: 500px;
            z-index: 100;
        }

        .question-display {
            text-align: center;
            margin-bottom: 10px;
            padding: 8px;
            background: rgba(0,0,0,0.7);
            border-radius: 8px;
            border: 1px solid #415a77;
        }

        .question-text {
            font-size: 16px;
            font-weight: bold;
            color: #fff;
        }

        .question-text-en {
            font-size: 11px;
            color: #4ecdc4;
        }

        .selection-row {
            margin-bottom: 8px;
        }

        .selection-label {
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .selection-label.debit { color: #4ecdc4; }
        .selection-label.credit { color: #ff6b6b; }

        .selected-display {
            font-size: 11px;
            padding: 3px 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
        }

        .choices {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 6px;
        }

        .choice-btn {
            padding: 10px 6px;
            background: linear-gradient(135deg, #1a1a2e 0%, #0d1b2a 100%);
            border: 2px solid #415a77;
            border-radius: 8px;
            color: #fff;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.15s ease;
            text-align: center;
        }

        .choice-btn:active { transform: scale(0.95); }
        .choice-btn.selected {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.3);
            box-shadow: 0 0 10px rgba(78, 205, 196, 0.3);
        }
        .choice-btn.correct {
            border-color: #4ecdc4;
            background: rgba(78, 205, 196, 0.5);
        }
        .choice-btn.incorrect {
            border-color: #e63946;
            background: rgba(230, 57, 70, 0.5);
        }

        .choice-en { font-size: 10px; color: #4ecdc4; }
        .choice-jp { font-size: 12px; color: #fff; }

        /* „Éú„Çø„É≥„Ç®„É™„Ç¢ */
        .button-row {
            display: flex;
            gap: 10px;
        }

        .attack-btn {
            flex: 1;
            padding: 12px;
            background: linear-gradient(135deg, #e63946 0%, #ff6b6b 100%);
            border: none;
            border-radius: 8px;
            color: #fff;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .attack-btn:disabled {
            background: #333;
            color: #666;
        }

        .special-btn {
            padding: 12px 20px;
            background: linear-gradient(135deg, #f39c12 0%, #ffd60a 100%);
            border: none;
            border-radius: 8px;
            color: #000;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            opacity: 0.3;
            transition: all 0.2s ease;
        }

        .special-btn.ready {
            opacity: 1;
            animation: specialBtnPulse 0.5s ease infinite alternate;
        }

        @keyframes specialBtnPulse {
            from { box-shadow: 0 0 10px #ffd60a; }
            to { box-shadow: 0 0 30px #ffd60a; }
        }

        /* „Éí„ÉÉ„Éà„Ç®„Éï„Çß„ÇØ„Éà */
        .hit-effect {
            position: fixed;
            top: 40%;
            left: 60%;
            font-size: 72px;
            font-weight: bold;
            color: #4ecdc4;
            text-shadow: 0 0 30px #4ecdc4, 3px 3px 0 #000;
            pointer-events: none;
            opacity: 0;
            z-index: 200;
        }

        .hit-effect.show {
            animation: hitEffectAnim 0.5s ease-out forwards;
        }

        @keyframes hitEffectAnim {
            0% { opacity: 1; transform: scale(0.5) rotate(-10deg); }
            30% { opacity: 1; transform: scale(1.3) rotate(5deg); }
            100% { opacity: 0; transform: scale(1.5) translateY(-50px) rotate(0deg); }
        }

        .damage-text {
            position: fixed;
            top: 35%;
            left: 20%;
            font-size: 48px;
            font-weight: bold;
            color: #e63946;
            text-shadow: 0 0 20px #e63946, 2px 2px 0 #000;
            pointer-events: none;
            opacity: 0;
            z-index: 200;
        }

        .damage-text.show {
            animation: damageTextAnim 0.6s ease-out forwards;
        }

        @keyframes damageTextAnim {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: translateY(-30px); }
        }

        /* ÁîªÈù¢„Éï„É©„ÉÉ„Ç∑„É• */
        .screen-flash {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 150;
            opacity: 0;
        }

        .screen-flash.hit {
            background: #4ecdc4;
            animation: flashAnim 0.1s ease;
        }

        .screen-flash.damage {
            background: #e63946;
            animation: flashAnim 0.15s ease;
        }

        @keyframes flashAnim {
            0% { opacity: 0.5; }
            100% { opacity: 0; }
        }

        /* ÁîªÈù¢„Ç∑„Çß„Ç§„ÇØ */
        .game-container.shake {
            animation: screenShake 0.3s ease;
        }

        @keyframes screenShake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-10px) rotate(-1deg); }
            40% { transform: translateX(10px) rotate(1deg); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* „Ç™„Éº„Éê„Éº„É¨„Ç§ */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .overlay.show {
            opacity: 1;
            pointer-events: auto;
        }

        .overlay-content {
            text-align: center;
            max-width: 400px;
            padding: 30px 20px;
            width: 95%;
        }

        .game-title {
            font-size: 42px;
            font-weight: bold;
            background: linear-gradient(135deg, #4ecdc4 0%, #ffd60a 50%, #ff6b6b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
        }

        .game-subtitle {
            font-size: 16px;
            color: #778da9;
            margin-bottom: 25px;
        }

        .instructions {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 25px;
            text-align: left;
            font-size: 13px;
            line-height: 1.9;
        }

        .instructions h3 {
            color: #4ecdc4;
            margin-bottom: 10px;
        }

        .start-btn {
            padding: 18px 60px;
            background: linear-gradient(135deg, #e63946 0%, #ff6b6b 100%);
            border: none;
            border-radius: 12px;
            color: #fff;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 3px;
            transition: transform 0.2s;
        }

        .start-btn:active { transform: scale(0.95); }

        .result-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin: 20px 0;
        }

        .result-stat {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
        }

        .result-stat .label { font-size: 11px; color: #888; }
        .result-stat .value { font-size: 26px; font-weight: bold; color: #4ecdc4; }

        /* „Çø„Ç§„Éû„ÉºÔºàÊïµ„ÅÆÊé•ËøëÂ∫¶Ôºâ */
        .approach-indicator {
            position: absolute;
            bottom: 190px;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .approach-bar-bg {
            flex: 1;
            height: 6px;
            background: #222;
            border-radius: 3px;
            overflow: hidden;
        }

        .approach-bar {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4 0%, #ffd60a 50%, #e63946 100%);
            transition: width 0.1s linear;
        }

        .approach-label {
            font-size: 10px;
            color: #888;
        }

        /* „Çπ„Éû„ÉõÂØæÂøú - Á∏¶Âûã„É¨„Ç§„Ç¢„Ç¶„Éà */
        @media (max-width: 600px) {
            .game-container {
                display: flex;
                flex-direction: column;
                height: 100vh;
                height: 100dvh;
            }

            .bg-effect { display: none; }

            /* „Éò„ÉÉ„ÉÄ„ÉºÔºö„Ç≥„É≥„Éë„ÇØ„Éà */
            .game-header {
                position: relative;
                padding: 8px;
                flex-shrink: 0;
            }

            .hp-bar-bg { width: 80px; height: 12px; }
            .special-bar-bg { width: 80px; height: 8px; }
            .hp-label, .special-label { font-size: 10px; }
            .stat-box { padding: 3px 6px; }
            .stat-value { font-size: 14px; }
            .stat-label { font-size: 8px; }

            /* ÂÖ•Âäõ„Ç®„É™„Ç¢Ôºö‰∏äÈÉ®„Å´ÈÖçÁΩÆ */
            .input-area {
                position: relative;
                top: auto;
                bottom: auto;
                left: auto;
                transform: none;
                width: 100%;
                max-width: none;
                padding: 5px 8px;
                flex-shrink: 0;
                order: -1;
            }

            .question-display {
                padding: 8px;
                margin-bottom: 8px;
            }

            .question-text { font-size: 15px; }
            .question-text-en { font-size: 10px; }

            .selection-row { margin-bottom: 6px; }
            .selection-label { font-size: 11px; margin-bottom: 4px; }

            .choices { gap: 5px; }

            .choice-btn {
                padding: 14px 6px;
                min-height: 54px;
            }

            .choice-en { font-size: 9px; }
            .choice-jp { font-size: 12px; font-weight: bold; }

            .button-row { gap: 8px; margin-top: 5px; }

            .attack-btn {
                padding: 16px;
                font-size: 18px;
                min-height: 56px;
            }

            .special-btn {
                padding: 16px;
                font-size: 16px;
                min-height: 56px;
            }

            /* „Éê„Éà„É´„Ç®„É™„Ç¢Ôºö‰∏ãÈÉ®„Å´„Ç≥„É≥„Éë„ÇØ„ÉàÈÖçÁΩÆ */
            .battlefield {
                position: relative;
                height: auto;
                flex: 1;
                min-height: 100px;
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 10px 20px;
                background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.5) 100%);
            }

            .ground { display: none; }

            .player {
                position: relative;
                bottom: auto;
                left: auto;
                font-size: 48px;
            }

            .enemy {
                position: relative;
                bottom: auto;
                right: auto !important;
                display: flex;
                flex-direction: column;
                align-items: center;
            }

            .enemy-sprite { font-size: 48px; }
            .enemy.boss .enemy-sprite { font-size: 60px; }

            .enemy-info {
                position: relative;
                bottom: auto;
                left: auto;
                transform: none;
                min-width: 120px;
                padding: 5px 8px;
                margin-bottom: 5px;
            }

            .enemy-name { font-size: 11px; }
            .enemy-name-en { font-size: 9px; }

            .approach-indicator {
                position: absolute;
                bottom: 5px;
                left: 50%;
                transform: translateX(-50%);
                width: 80%;
            }

            /* „Ç≥„É≥„ÉúË°®Á§∫ */
            .combo-display {
                position: absolute;
                top: auto;
                bottom: 30px;
                left: 50%;
                transform: translateX(-50%);
            }

            .combo-count { font-size: 32px; }
            .combo-label { font-size: 10px; }

            /* „Ç®„Éï„Çß„ÇØ„Éà */
            .hit-effect { font-size: 48px; top: 50%; }
            .damage-text { font-size: 32px; top: 50%; left: 50%; transform: translateX(-50%); }
            .boss-warning-text { font-size: 28px; }

            /* „Ç™„Éº„Éê„Éº„É¨„Ç§ */
            .game-title { font-size: 28px; }
            .instructions { padding: 12px; font-size: 12px; line-height: 1.7; }
            .instructions h3 { font-size: 14px; }
            .start-btn { padding: 14px 40px; font-size: 18px; }
            .result-stats { gap: 8px; }
            .result-stat { padding: 10px; }
            .result-stat .value { font-size: 22px; }
        }
    </style>
</head>
<body>
    <div class="game-container" id="gameContainer">
        <div class="bg-effect"></div>

        <!-- „Çπ„Çø„Éº„ÉàÁîªÈù¢ -->
        <div class="overlay show" id="startOverlay">
            <div class="overlay-content">
                <h1 class="game-title">ENTRY STRIKE</h1>
                <p class="game-subtitle">‰ªïË®≥Ê†ºÈóò„Ç≤„Éº„É†</p>
                <div class="instructions">
                    <h3>ÈÅä„Å≥Êñπ</h3>
                    <p>‚öîÔ∏è Êïµ„ÅåËø´„ÇãÂâç„Å´Ê≠£„Åó„ÅÑ‰ªïË®≥„ÇíÈÅ∏„ÅπÔºÅ</p>
                    <p>üéØ Dr/Cr„ÇíÈÅ∏Êäû„Åó„Å¶ATTACK!</p>
                    <p>üí• Ê≠£Ëß£„ÅßÊîªÊíÉ„ÄÅ‰∏çÊ≠£Ëß£„ÅßÂèçÊíÉ</p>
                    <p>üî• „Ç≥„É≥„Éú„ÅßÂøÖÊÆ∫„Ç≤„Éº„Ç∏UP</p>
                    <p>üëë 5‰Ωì„Åî„Å®„Å´„Éú„ÇπÔºÅÂøÖÊÆ∫ÊäÄ„ÅßÂÄí„ÅõÔºÅ</p>
                </div>
                <button class="start-btn" onclick="startGame()">FIGHT!</button>
            </div>
        </div>

        <!-- „Ç≤„Éº„É†„Ç™„Éº„Éê„Éº -->
        <div class="overlay" id="gameOverOverlay">
            <div class="overlay-content">
                <h1 class="game-title" id="resultTitle">GAME OVER</h1>
                <div class="result-stats">
                    <div class="result-stat">
                        <div class="label">SCORE</div>
                        <div class="value" id="finalScore">0</div>
                    </div>
                    <div class="result-stat">
                        <div class="label">MAX COMBO</div>
                        <div class="value" id="finalCombo">0</div>
                    </div>
                    <div class="result-stat">
                        <div class="label">ENEMIES</div>
                        <div class="value" id="finalEnemies">0</div>
                    </div>
                    <div class="result-stat">
                        <div class="label">BOSSES</div>
                        <div class="value" id="finalBosses">0</div>
                    </div>
                </div>
                <button class="start-btn" onclick="startGame()">RETRY</button>
            </div>
        </div>

        <!-- „Éú„ÇπË≠¶Âëä -->
        <div class="boss-warning" id="bossWarning">
            <div class="boss-warning-text">‚ö†Ô∏è BOSS APPROACHING ‚ö†Ô∏è</div>
        </div>

        <!-- „Ç≤„Éº„É†UI -->
        <div class="game-header">
            <div class="player-status">
                <div class="hp-container">
                    <span class="hp-label">HP</span>
                    <div class="hp-bar-bg">
                        <div class="hp-bar" id="playerHpBar"></div>
                    </div>
                </div>
                <div class="special-container">
                    <span class="special-label">SP</span>
                    <div class="special-bar-bg">
                        <div class="special-bar" id="specialBar"></div>
                    </div>
                </div>
            </div>
            <div class="stats">
                <div class="stat-box">
                    <div class="stat-label">Score</div>
                    <div class="stat-value" id="score">0</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Round</div>
                    <div class="stat-value" id="round">1</div>
                </div>
            </div>
        </div>

        <div class="combo-display" id="comboDisplay">
            <div class="combo-count" id="comboCount">0</div>
            <div class="combo-label">COMBO</div>
        </div>

        <!-- „Éó„É¨„Ç§„É§„Éº -->
        <div class="player" id="player">ü•∑</div>

        <!-- Êïµ -->
        <div class="enemy" id="enemy">
            <div class="enemy-info">
                <div class="enemy-name" id="enemyName">Êïµ</div>
                <div class="enemy-name-en" id="enemyNameEn">Enemy</div>
                <div class="enemy-hp-bar-bg">
                    <div class="enemy-hp-bar" id="enemyHpBar"></div>
                </div>
            </div>
            <div class="enemy-sprite" id="enemySprite">üëπ</div>
        </div>

        <!-- Êé•Ëøë„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº -->
        <div class="approach-indicator">
            <span class="approach-label">DANGER</span>
            <div class="approach-bar-bg">
                <div class="approach-bar" id="approachBar"></div>
            </div>
        </div>

        <div class="ground"></div>
        <div class="battlefield"></div>

        <!-- ÂÖ•Âäõ„Ç®„É™„Ç¢ -->
        <div class="input-area">
            <div class="question-display">
                <div class="question-text" id="questionText">ÂïèÈ°å</div>
                <div class="question-text-en" id="questionTextEn">Question</div>
            </div>

            <div class="selection-row" id="debitRow">
                <div class="selection-label debit">
                    DrÔºàÂÄüÊñπÔºâ<span class="selected-display" id="debitDisplay">-</span>
                </div>
                <div class="choices" id="debitChoices"></div>
            </div>

            <div class="selection-row" id="creditRow">
                <div class="selection-label credit">
                    CrÔºàË≤∏ÊñπÔºâ<span class="selected-display" id="creditDisplay">-</span>
                </div>
                <div class="choices" id="creditChoices"></div>
            </div>

            <div class="button-row">
                <button class="attack-btn" id="attackBtn" onclick="attack()" disabled>ATTACK!</button>
                <button class="special-btn" id="specialBtn" onclick="specialAttack()">ÂøÖÊÆ∫</button>
            </div>
        </div>

        <!-- „Ç®„Éï„Çß„ÇØ„Éà -->
        <div class="hit-effect" id="hitEffect">HIT!</div>
        <div class="damage-text" id="damageText">DAMAGE!</div>
        <div class="screen-flash" id="screenFlash"></div>
    </div>

    <script>
        // ÂãòÂÆöÁßëÁõÆ
        const ACCOUNTS = {
            cash: { en: 'Cash', jp: 'ÁèæÈáë' },
            accountsReceivable: { en: 'A/R', jp: 'Â£≤ÊéõÈáë' },
            inventory: { en: 'Inventory', jp: 'Ê£öÂç∏Ë≥áÁî£' },
            supplies: { en: 'Supplies', jp: 'Ê∂àËÄóÂìÅ' },
            prepaidExpenses: { en: 'Prepaid Exp.', jp: 'ÂâçÊâïË≤ªÁî®' },
            equipment: { en: 'Equipment', jp: 'ÂÇôÂìÅ' },
            buildings: { en: 'Buildings', jp: 'Âª∫Áâ©' },
            land: { en: 'Land', jp: 'ÂúüÂú∞' },
            accumulatedDepreciation: { en: 'Acc. Depr.', jp: 'Ê∏õ‰æ°ÂÑüÂç¥Á¥ØË®àÈ°ç' },
            rightOfUseAsset: { en: 'ROU Asset', jp: '‰ΩøÁî®Ê®©Ë≥áÁî£' },
            goodwill: { en: 'Goodwill', jp: '„ÅÆ„Çå„Çì' },
            investmentInSub: { en: 'Invest. Sub.', jp: 'Â≠ê‰ºöÁ§æÊ†™Âºè' },
            accountsPayable: { en: 'A/P', jp: 'Ë≤∑ÊéõÈáë' },
            notesPayable: { en: 'N/P', jp: 'ÊîØÊâïÊâãÂΩ¢' },
            unearnedRevenue: { en: 'Unearned Rev.', jp: 'ÂâçÂèóÂèéÁõä' },
            accruedExpenses: { en: 'Accrued Exp.', jp: 'Êú™ÊâïË≤ªÁî®' },
            bondsPayable: { en: 'Bonds Pay.', jp: 'Á§æÂÇµ' },
            leaseLiability: { en: 'Lease Liab.', jp: '„É™„Éº„ÇπË≤†ÂÇµ' },
            commonStock: { en: 'Common Stock', jp: 'Ë≥áÊú¨Èáë' },
            retainedEarnings: { en: 'Ret. Earnings', jp: 'Âà©ÁõäÂâ∞‰ΩôÈáë' },
            sales: { en: 'Sales', jp: 'Â£≤‰∏ä' },
            serviceRevenue: { en: 'Service Rev.', jp: 'ÂΩπÂãôÂèéÁõä' },
            interestIncome: { en: 'Int. Income', jp: 'ÂèóÂèñÂà©ÊÅØ' },
            costOfGoodsSold: { en: 'COGS', jp: 'Â£≤‰∏äÂéü‰æ°' },
            salariesExpense: { en: 'Salaries Exp.', jp: 'Áµ¶‰∏é' },
            rentExpense: { en: 'Rent Exp.', jp: 'ÊîØÊâïÂÆ∂Ë≥É' },
            depreciationExpense: { en: 'Depr. Exp.', jp: 'Ê∏õ‰æ°ÂÑüÂç¥Ë≤ª' },
            suppliesExpense: { en: 'Supplies Exp.', jp: 'Ê∂àËÄóÂìÅË≤ª' },
            interestExpense: { en: 'Int. Exp.', jp: 'ÊîØÊâïÂà©ÊÅØ' },
            utilitiesExpense: { en: 'Utilities Exp.', jp: 'Ê∞¥ÈÅìÂÖâÁÜ±Ë≤ª' }
        };

        // Êïµ„ÅÆÁ®ÆÈ°û
        const ENEMY_SPRITES = ['üëπ', 'üë∫', 'üëª', 'üíÄ', 'üëæ', 'ü§ñ', 'üëø', 'ü¶π'];
        const BOSS_SPRITES = ['üêâ', 'üëë', '‚öîÔ∏è', 'üî•'];

        // ÂèñÂºï„Éá„Éº„Çø
        const TRANSACTIONS = {
            normal: [
                { id: 'n1', title: 'ÂÇôÂìÅ„ÅÆË≥ºÂÖ•ÔºàÁèæÈáëÔºâ', titleEn: 'Purchase equipment', debit: 'equipment', credit: 'cash', debitPool: ['equipment', 'supplies', 'inventory', 'buildings'], creditPool: ['cash', 'accountsPayable', 'notesPayable', 'accruedExpenses'] },
                { id: 'n2', title: 'Â£≤ÊéõÈáë„ÅÆÂõûÂèé', titleEn: 'Collect receivables', debit: 'cash', credit: 'accountsReceivable', debitPool: ['cash', 'inventory', 'supplies', 'equipment'], creditPool: ['accountsReceivable', 'sales', 'unearnedRevenue', 'accountsPayable'] },
                { id: 'n3', title: 'Ê∂àËÄóÂìÅ„ÅÆË≥ºÂÖ•', titleEn: 'Purchase supplies', debit: 'supplies', credit: 'cash', debitPool: ['supplies', 'inventory', 'equipment', 'prepaidExpenses'], creditPool: ['cash', 'accountsPayable', 'notesPayable', 'accruedExpenses'] },
                { id: 'n4', title: 'Ë≤∑ÊéõÈáë„ÅÆÊîØÊâï„ÅÑ', titleEn: 'Pay accounts payable', debit: 'accountsPayable', credit: 'cash', debitPool: ['accountsPayable', 'notesPayable', 'accruedExpenses', 'unearnedRevenue'], creditPool: ['cash', 'accountsReceivable', 'inventory', 'supplies'] },
                { id: 'n5', title: 'ÁèæÈáëÂ£≤‰∏ä', titleEn: 'Cash sales', debit: 'cash', credit: 'sales', debitPool: ['cash', 'accountsReceivable', 'inventory', 'supplies'], creditPool: ['sales', 'serviceRevenue', 'unearnedRevenue', 'interestIncome'] },
                { id: 'n6', title: 'ÂïÜÂìÅ„ÅÆ‰ªïÂÖ•ÔºàÁèæÈáëÔºâ', titleEn: 'Purchase inventory', debit: 'inventory', credit: 'cash', debitPool: ['inventory', 'supplies', 'equipment', 'prepaidExpenses'], creditPool: ['cash', 'accountsPayable', 'notesPayable', 'unearnedRevenue'] },
                { id: 'n7', title: 'ÂïÜÂìÅ„ÅÆ‰ªïÂÖ•ÔºàÊéõ„ÅëÔºâ', titleEn: 'Purchase on account', debit: 'inventory', credit: 'accountsPayable', debitPool: ['inventory', 'supplies', 'equipment', 'buildings'], creditPool: ['accountsPayable', 'cash', 'notesPayable', 'accruedExpenses'] },
                { id: 'n8', title: 'Ê∏õ‰æ°ÂÑüÂç¥„ÅÆË®à‰∏ä', titleEn: 'Record depreciation', debit: 'depreciationExpense', credit: 'accumulatedDepreciation', debitPool: ['depreciationExpense', 'suppliesExpense', 'rentExpense', 'salariesExpense'], creditPool: ['accumulatedDepreciation', 'cash', 'accountsPayable', 'equipment'] },
                { id: 'n9', title: 'Êéõ„ÅëÂ£≤‰∏ä', titleEn: 'Sales on account', debit: 'accountsReceivable', credit: 'sales', debitPool: ['accountsReceivable', 'cash', 'inventory', 'supplies'], creditPool: ['sales', 'serviceRevenue', 'unearnedRevenue', 'accountsPayable'] },
                { id: 'n10', title: 'Áµ¶‰∏é„ÅÆÊîØÊâï„ÅÑ', titleEn: 'Pay salaries', debit: 'salariesExpense', credit: 'cash', debitPool: ['salariesExpense', 'rentExpense', 'utilitiesExpense', 'suppliesExpense'], creditPool: ['cash', 'accruedExpenses', 'accountsPayable', 'notesPayable'] },
                { id: 'n11', title: 'ÂâçÊâïË≤ªÁî®„ÅÆË®à‰∏ä', titleEn: 'Record prepaid', debit: 'prepaidExpenses', credit: 'cash', debitPool: ['prepaidExpenses', 'supplies', 'inventory', 'equipment'], creditPool: ['cash', 'accountsPayable', 'accruedExpenses', 'notesPayable'] },
                { id: 'n12', title: 'Ê∂àËÄóÂìÅ„ÅÆË≤ªÁî®Âåñ', titleEn: 'Supplies used', debit: 'suppliesExpense', credit: 'supplies', debitPool: ['suppliesExpense', 'depreciationExpense', 'utilitiesExpense', 'rentExpense'], creditPool: ['supplies', 'cash', 'inventory', 'prepaidExpenses'] },
                { id: 'n13', title: 'ÂÆ∂Ë≥É„ÅÆÊîØÊâï„ÅÑ', titleEn: 'Pay rent', debit: 'rentExpense', credit: 'cash', debitPool: ['rentExpense', 'salariesExpense', 'utilitiesExpense', 'interestExpense'], creditPool: ['cash', 'accountsPayable', 'accruedExpenses', 'prepaidExpenses'] },
                { id: 'n14', title: 'Â£≤‰∏äÂéü‰æ°„ÅÆË®à‰∏ä', titleEn: 'Record COGS', debit: 'costOfGoodsSold', credit: 'inventory', debitPool: ['costOfGoodsSold', 'suppliesExpense', 'depreciationExpense', 'salariesExpense'], creditPool: ['inventory', 'supplies', 'cash', 'accountsPayable'] },
                { id: 'n15', title: 'ÂâçÂèóÂèéÁõä„ÅÆÂèéÁõäÂåñ', titleEn: 'Earn revenue', debit: 'unearnedRevenue', credit: 'serviceRevenue', debitPool: ['unearnedRevenue', 'accountsPayable', 'accruedExpenses', 'notesPayable'], creditPool: ['serviceRevenue', 'sales', 'interestIncome', 'cash'] },
                { id: 'n16', title: 'Á§æÂÇµ„ÅÆÁô∫Ë°å', titleEn: 'Issue bonds', debit: 'cash', credit: 'bondsPayable', debitPool: ['cash', 'accountsReceivable', 'equipment', 'buildings'], creditPool: ['bondsPayable', 'commonStock', 'notesPayable', 'leaseLiability'] },
                { id: 'n17', title: 'Ê†™Âºè„ÅÆÁô∫Ë°å', titleEn: 'Issue stock', debit: 'cash', credit: 'commonStock', debitPool: ['cash', 'equipment', 'buildings', 'land'], creditPool: ['commonStock', 'bondsPayable', 'retainedEarnings', 'accountsPayable'] },
                { id: 'n18', title: 'ÊîØÊâïÂà©ÊÅØ„ÅÆË®à‰∏ä', titleEn: 'Accrue interest', debit: 'interestExpense', credit: 'accruedExpenses', debitPool: ['interestExpense', 'rentExpense', 'salariesExpense', 'depreciationExpense'], creditPool: ['accruedExpenses', 'cash', 'bondsPayable', 'notesPayable'] }
            ],
            boss: [
                { id: 'b1', title: '„É™„Éº„ÇπË≥áÁî£„ÅÆË®à‰∏ä', titleEn: 'Recognize lease (IFRS16)', debit: 'rightOfUseAsset', credit: 'leaseLiability', debitPool: ['rightOfUseAsset', 'equipment', 'buildings', 'goodwill'], creditPool: ['leaseLiability', 'bondsPayable', 'cash', 'accountsPayable'] },
                { id: 'b2', title: '„ÅÆ„Çå„Çì„ÅÆË®à‰∏ä', titleEn: 'Record goodwill', debit: 'goodwill', credit: 'cash', debitPool: ['goodwill', 'rightOfUseAsset', 'investmentInSub', 'buildings'], creditPool: ['cash', 'bondsPayable', 'commonStock', 'accountsPayable'] },
                { id: 'b3', title: 'ÈÄ£ÁµêÊ∂àÂéªÔºöÊäïË≥á„Å®Ë≥áÊú¨', titleEn: 'Eliminate investment', debit: 'commonStock', credit: 'investmentInSub', debitPool: ['commonStock', 'retainedEarnings', 'goodwill', 'rightOfUseAsset'], creditPool: ['investmentInSub', 'cash', 'bondsPayable', 'leaseLiability'] },
                { id: 'b4', title: '„É™„Éº„ÇπË≤†ÂÇµ„ÅÆËøîÊ∏à', titleEn: 'Lease payment', debit: 'leaseLiability', credit: 'cash', debitPool: ['leaseLiability', 'bondsPayable', 'rightOfUseAsset', 'interestExpense'], creditPool: ['cash', 'accountsPayable', 'accruedExpenses', 'notesPayable'] },
                { id: 'b5', title: 'Â≠ê‰ºöÁ§æ„Å∏„ÅÆÊäïË≥á', titleEn: 'Invest in subsidiary', debit: 'investmentInSub', credit: 'cash', debitPool: ['investmentInSub', 'goodwill', 'equipment', 'buildings'], creditPool: ['cash', 'commonStock', 'bondsPayable', 'accountsPayable'] }
            ]
        };

        // „Ç≤„Éº„É†Áä∂ÊÖã
        let game = {
            hp: 100,
            maxHp: 100,
            score: 0,
            round: 1,
            combo: 0,
            maxCombo: 0,
            specialGauge: 0,
            enemiesDefeated: 0,
            bossesDefeated: 0,
            isRunning: false,
            isBoss: false,
            enemyHp: 1,
            enemyMaxHp: 1,
            currentTransaction: null,
            selectedDebit: null,
            selectedCredit: null,
            approachTimer: null,
            approachValue: 0,
            recentQuestions: []
        };

        // DOMË¶ÅÁ¥†
        const $ = id => document.getElementById(id);

        function shuffle(arr) {
            const a = [...arr];
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        function updateUI() {
            $('playerHpBar').style.width = (game.hp / game.maxHp * 100) + '%';
            $('specialBar').style.width = Math.min(100, game.specialGauge) + '%';
            $('specialBar').classList.toggle('ready', game.specialGauge >= 100);
            $('specialBtn').classList.toggle('ready', game.specialGauge >= 100);
            $('score').textContent = game.score;
            $('round').textContent = game.round;
            $('enemyHpBar').style.width = (game.enemyHp / game.enemyMaxHp * 100) + '%';

            $('comboDisplay').classList.toggle('active', game.combo > 0);
            $('comboCount').textContent = game.combo;

            $('attackBtn').disabled = !(game.selectedDebit && game.selectedCredit);
        }

        function spawnEnemy() {
            // „Éú„ÇπÂà§ÂÆö: 5‰Ωì„Åî„Å®
            game.isBoss = game.enemiesDefeated > 0 && game.enemiesDefeated % 5 === 0;

            if (game.isBoss) {
                showBossWarning();
                return;
            }

            setupEnemy();
        }

        function showBossWarning() {
            $('bossWarning').classList.add('show');
            setTimeout(() => {
                $('bossWarning').classList.remove('show');
                setupEnemy();
            }, 2000);
        }

        function setupEnemy() {
            const pool = game.isBoss ? TRANSACTIONS.boss : TRANSACTIONS.normal;
            let available = pool.filter(t => !game.recentQuestions.includes(t.id));
            if (available.length === 0) {
                game.recentQuestions = [];
                available = pool;
            }

            const transaction = available[Math.floor(Math.random() * available.length)];
            game.currentTransaction = transaction;
            game.recentQuestions.push(transaction.id);
            if (game.recentQuestions.length > 5) game.recentQuestions.shift();

            // Êïµ„ÅÆË¶ã„ÅüÁõÆ
            const enemy = $('enemy');
            enemy.classList.remove('defeated', 'hit', 'attacking');
            enemy.classList.toggle('boss', game.isBoss);
            enemy.style.right = '10%';

            const sprite = game.isBoss
                ? BOSS_SPRITES[Math.floor(Math.random() * BOSS_SPRITES.length)]
                : ENEMY_SPRITES[Math.floor(Math.random() * ENEMY_SPRITES.length)];
            $('enemySprite').textContent = sprite;

            // ÊïµHPÔºà„Éú„Çπ„ÇÇÈÄöÂ∏∏Êïµ„ÇÇ1ÂõûÊ≠£Ëß£„ÅßÊíÉÁ†¥Ôºâ
            game.enemyMaxHp = 1;
            game.enemyHp = 1;

            // ÂïèÈ°åË°®Á§∫
            const prefix = game.isBoss ? '„ÄêBOSS„Äë' : '';
            $('enemyName').textContent = prefix + transaction.title;
            $('enemyNameEn').textContent = transaction.titleEn;

            if (game.isBoss) {
                // „Éú„ÇπÊà¶ÔºöÂïèÈ°å„Å®ÈÅ∏ÊäûËÇ¢„ÇíË°®Á§∫„ÄÅÂøÖÊÆ∫ÊäÄ„ÅÆ„Åø„ÅßÂÄí„Åô
                $('questionText').textContent = '„ÄêBOSS„Äë' + transaction.title;
                $('questionTextEn').textContent = transaction.titleEn;
                $('debitRow').style.display = 'block';
                $('creditRow').style.display = 'block';
                $('attackBtn').style.display = 'none';

                // ÈÅ∏ÊäûËÇ¢„ÇíÁîüÊàê
                game.selectedDebit = null;
                game.selectedCredit = null;
                $('debitDisplay').textContent = '-';
                $('creditDisplay').textContent = '-';

                const debitChoices = shuffle(transaction.debitPool);
                const creditChoices = shuffle(transaction.creditPool);

                $('debitChoices').innerHTML = '';
                $('creditChoices').innerHTML = '';

                debitChoices.forEach(key => {
                    const btn = createChoiceBtn(key, 'debit');
                    $('debitChoices').appendChild(btn);
                });

                creditChoices.forEach(key => {
                    const btn = createChoiceBtn(key, 'credit');
                    $('creditChoices').appendChild(btn);
                });

                // ÂøÖÊÆ∫„Ç≤„Éº„Ç∏„Çí100%„Å´
                game.specialGauge = 100;
                // Êé•Ëøë„Çø„Ç§„Éû„ÉºÈñãÂßãÔºàÈÄöÂ∏∏Êïµ„Å®Âêå„ÅòÔºâ
                game.approachValue = 0;
                startApproachTimer();
            } else {
                // ÈÄöÂ∏∏ÊïµÔºöÈÅ∏ÊäûËÇ¢„ÇíË°®Á§∫
                $('questionText').textContent = transaction.title;
                $('questionTextEn').textContent = transaction.titleEn;
                $('debitRow').style.display = 'block';
                $('creditRow').style.display = 'block';
                $('attackBtn').style.display = 'block';

                game.selectedDebit = null;
                game.selectedCredit = null;
                $('debitDisplay').textContent = '-';
                $('creditDisplay').textContent = '-';

                const debitChoices = shuffle(transaction.debitPool);
                const creditChoices = shuffle(transaction.creditPool);

                $('debitChoices').innerHTML = '';
                $('creditChoices').innerHTML = '';

                debitChoices.forEach(key => {
                    const btn = createChoiceBtn(key, 'debit');
                    $('debitChoices').appendChild(btn);
                });

                creditChoices.forEach(key => {
                    const btn = createChoiceBtn(key, 'credit');
                    $('creditChoices').appendChild(btn);
                });

                // Êé•Ëøë„Çø„Ç§„Éû„ÉºÈñãÂßã
                game.approachValue = 0;
                startApproachTimer();
            }

            updateUI();
        }

        function createChoiceBtn(key, type) {
            const acc = ACCOUNTS[key];
            const btn = document.createElement('button');
            btn.className = 'choice-btn';
            btn.innerHTML = `<div class="choice-en">${acc.en}</div><div class="choice-jp">${acc.jp}</div>`;
            btn.onclick = () => selectChoice(key, type);
            btn.dataset.key = key;
            return btn;
        }

        function selectChoice(key, type) {
            if (!game.isRunning) return;

            const container = type === 'debit' ? $('debitChoices') : $('creditChoices');
            container.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('selected'));
            container.querySelector(`[data-key="${key}"]`).classList.add('selected');

            if (type === 'debit') {
                game.selectedDebit = key;
                $('debitDisplay').textContent = ACCOUNTS[key].jp;
            } else {
                game.selectedCredit = key;
                $('creditDisplay').textContent = ACCOUNTS[key].jp;
            }

            updateUI();
        }

        function startApproachTimer() {
            clearInterval(game.approachTimer);
            const maxTime = 100;

            game.approachTimer = setInterval(() => {
                game.approachValue += 1;
                const percent = (game.approachValue / maxTime) * 100;
                $('approachBar').style.width = percent + '%';

                // Êïµ„ÅåÊé•Ëøë
                const approachPercent = Math.min(game.approachValue / maxTime, 1);
                $('enemy').style.right = (10 + approachPercent * 30) + '%';

                if (game.approachValue >= maxTime) {
                    // ÊôÇÈñìÂàá„Çå - Êïµ„ÅÆÊîªÊíÉ
                    enemyAttack();
                }
            }, 100);
        }

        function enemyAttack() {
            clearInterval(game.approachTimer);

            $('enemy').classList.add('attacking');
            setTimeout(() => $('enemy').classList.remove('attacking'), 500);

            $('player').classList.add('damage');
            setTimeout(() => $('player').classList.remove('damage'), 400);

            $('screenFlash').classList.add('damage');
            setTimeout(() => $('screenFlash').classList.remove('damage'), 150);

            $('gameContainer').classList.add('shake');
            setTimeout(() => $('gameContainer').classList.remove('shake'), 300);

            $('damageText').textContent = '-20';
            $('damageText').classList.add('show');
            setTimeout(() => $('damageText').classList.remove('show'), 600);

            game.hp -= 20;
            game.combo = 0;
            updateUI();

            if (game.hp <= 0) {
                gameOver();
            } else {
                setTimeout(spawnEnemy, 800);
            }
        }

        function attack() {
            if (!game.isRunning || !game.selectedDebit || !game.selectedCredit) return;
            clearInterval(game.approachTimer);

            const t = game.currentTransaction;
            const debitOk = game.selectedDebit === t.debit;
            const creditOk = game.selectedCredit === t.credit;

            // Ê≠£Ëß£Ë°®Á§∫
            $('debitChoices').querySelectorAll('.choice-btn').forEach(btn => {
                if (btn.dataset.key === t.debit) btn.classList.add('correct');
                else if (btn.classList.contains('selected')) btn.classList.add('incorrect');
            });
            $('creditChoices').querySelectorAll('.choice-btn').forEach(btn => {
                if (btn.dataset.key === t.credit) btn.classList.add('correct');
                else if (btn.classList.contains('selected')) btn.classList.add('incorrect');
            });

            if (debitOk && creditOk) {
                // Ê≠£Ëß£ÔºÅ
                playerAttack();
            } else {
                // ‰∏çÊ≠£Ëß£
                game.combo = 0;
                $('damageText').textContent = 'MISS!';
                $('damageText').classList.add('show');
                setTimeout(() => $('damageText').classList.remove('show'), 600);

                setTimeout(() => enemyAttack(), 500);
            }
        }

        function playerAttack() {
            $('player').classList.add('attack');
            setTimeout(() => $('player').classList.remove('attack'), 400);

            $('enemy').classList.add('hit');
            setTimeout(() => $('enemy').classList.remove('hit'), 300);

            $('screenFlash').classList.add('hit');
            setTimeout(() => $('screenFlash').classList.remove('hit'), 100);

            game.enemyHp--;
            game.combo++;
            if (game.combo > game.maxCombo) game.maxCombo = game.combo;
            game.specialGauge += 20;

            const baseScore = game.isBoss ? 200 : 100;
            const comboBonus = game.combo * 15;
            const timeBonus = Math.floor((100 - game.approachValue) / 5);
            const totalScore = baseScore + comboBonus + timeBonus;
            game.score += totalScore;

            $('hitEffect').textContent = game.enemyHp > 0 ? 'HIT!' : (game.isBoss ? 'DEFEATED!' : 'K.O!');
            $('hitEffect').classList.add('show');
            setTimeout(() => $('hitEffect').classList.remove('show'), 500);

            updateUI();

            if (game.enemyHp <= 0) {
                // ÊïµÊíÉÁ†¥
                $('enemy').classList.add('defeated');
                game.enemiesDefeated++;
                if (game.isBoss) game.bossesDefeated++;
                game.round++;

                setTimeout(spawnEnemy, 800);
            } else {
                // „Éú„ÇπÁ∂ôÁ∂ö
                setTimeout(() => {
                    game.selectedDebit = null;
                    game.selectedCredit = null;
                    $('debitDisplay').textContent = '-';
                    $('creditDisplay').textContent = '-';
                    $('debitChoices').querySelectorAll('.choice-btn').forEach(b => {
                        b.classList.remove('selected', 'correct', 'incorrect');
                    });
                    $('creditChoices').querySelectorAll('.choice-btn').forEach(b => {
                        b.classList.remove('selected', 'correct', 'incorrect');
                    });
                    game.approachValue = 0;
                    startApproachTimer();
                    updateUI();
                }, 500);
            }
        }

        function specialAttack() {
            if (game.specialGauge < 100 || !game.isRunning) return;

            game.specialGauge = 0;

            $('player').classList.add('special');
            setTimeout(() => $('player').classList.remove('special'), 800);

            $('screenFlash').classList.add('hit');
            setTimeout(() => $('screenFlash').classList.remove('hit'), 100);
            setTimeout(() => {
                $('screenFlash').classList.add('hit');
                setTimeout(() => $('screenFlash').classList.remove('hit'), 100);
            }, 200);

            $('hitEffect').textContent = 'SPECIAL!';
            $('hitEffect').classList.add('show');
            setTimeout(() => $('hitEffect').classList.remove('show'), 500);

            // Êïµ„Å´Â§ß„ÉÄ„É°„Éº„Ç∏Ôºà„Éú„Çπ„ÇÇ‰∏ÄÊíÉ„ÅßÂÄí„Åõ„ÇãÔºâ
            game.enemyHp -= 3;
            game.score += 300;

            if (game.enemyHp <= 0) {
                clearInterval(game.approachTimer);
                $('enemy').classList.add('defeated');
                game.enemiesDefeated++;
                if (game.isBoss) game.bossesDefeated++;
                game.round++;
                setTimeout(spawnEnemy, 1000);
            }

            updateUI();
        }

        function startGame() {
            game = {
                hp: 100,
                maxHp: 100,
                score: 0,
                round: 1,
                combo: 0,
                maxCombo: 0,
                specialGauge: 0,
                enemiesDefeated: 0,
                bossesDefeated: 0,
                isRunning: true,
                isBoss: false,
                enemyHp: 1,
                enemyMaxHp: 1,
                currentTransaction: null,
                selectedDebit: null,
                selectedCredit: null,
                approachTimer: null,
                approachValue: 0,
                recentQuestions: []
            };

            $('startOverlay').classList.remove('show');
            $('gameOverOverlay').classList.remove('show');
            $('player').classList.remove('attack', 'damage', 'special');
            $('enemy').classList.remove('defeated', 'hit', 'attacking', 'boss');

            // UI„Çí„É™„Çª„ÉÉ„Éà
            $('debitRow').style.display = 'block';
            $('creditRow').style.display = 'block';
            $('attackBtn').style.display = 'block';

            updateUI();
            spawnEnemy();
        }

        function gameOver() {
            game.isRunning = false;
            clearInterval(game.approachTimer);

            $('resultTitle').textContent = game.bossesDefeated >= 3 ? 'VICTORY!' : 'GAME OVER';
            $('finalScore').textContent = game.score;
            $('finalCombo').textContent = game.maxCombo;
            $('finalEnemies').textContent = game.enemiesDefeated;
            $('finalBosses').textContent = game.bossesDefeated;

            $('gameOverOverlay').classList.add('show');
        }

        // „Ç≠„Éº„Éú„Éº„Éâ
        document.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                if (!game.isRunning) startGame();
                else attack();
            }
        });
    </script>
</body>
</html>
